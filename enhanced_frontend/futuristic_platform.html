<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIåä½œå¼€å‘å¹³å° - æœªæ¥ç§‘æŠ€</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600;700&display=swap');

        :root {
            --primary-glow: #00f5ff;
            --secondary-glow: #ff006e;
            --accent-glow: #7c3aed;
            --success-glow: #00ff88;
            --warning-glow: #ffaa00;
            --bg-dark: #0a0a0f;
            --bg-card: rgba(15, 15, 25, 0.8);
            --bg-glass: rgba(255, 255, 255, 0.05);
            --border-glow: rgba(0, 245, 255, 0.3);
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-accent: #00f5ff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-dark);
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(0, 245, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(255, 0, 110, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(124, 58, 237, 0.05) 0%, transparent 50%);
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* èƒŒæ™¯åŠ¨ç”» */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(45deg, transparent 49%, rgba(0, 245, 255, 0.03) 50%, transparent 51%),
                linear-gradient(-45deg, transparent 49%, rgba(255, 0, 110, 0.03) 50%, transparent 51%);
            background-size: 60px 60px;
            animation: backgroundMove 20s linear infinite;
            pointer-events: none;
            z-index: -1;
        }

        @keyframes backgroundMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(60px, 60px); }
        }

        /* æ¯›ç»ç’ƒæ•ˆæœåŸºç±» */
        .glass {
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-glow);
            border-radius: 20px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .glass-intense {
            background: var(--bg-card);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(0, 245, 255, 0.5);
            border-radius: 25px;
            box-shadow: 
                0 15px 50px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.15),
                0 0 30px rgba(0, 245, 255, 0.1);
        }

        /* ç™»å½•ç•Œé¢ */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            position: relative;
        }

        .login-box {
            width: 480px;
            padding: 50px;
            position: relative;
            animation: floatIn 1s ease-out;
        }

        @keyframes floatIn {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .login-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .login-header h1 {
            font-family: 'Orbitron', monospace;
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary-glow), var(--secondary-glow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 15px;
            text-shadow: 0 0 30px rgba(0, 245, 255, 0.5);
        }

        .login-header p {
            font-size: 1.1rem;
            color: var(--text-secondary);
            font-weight: 300;
        }

        .input-group {
            margin-bottom: 25px;
            position: relative;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-accent);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .input-group input {
            width: 100%;
            padding: 18px 20px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(0, 245, 255, 0.2);
            border-radius: 15px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-glow);
            box-shadow: 
                0 0 20px rgba(0, 245, 255, 0.3),
                inset 0 0 20px rgba(0, 245, 255, 0.05);
            transform: translateY(-2px);
        }

        .input-group input::placeholder {
            color: rgba(255, 255, 255, 0.3);
        }

        .btn {
            padding: 18px 30px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-glow), var(--accent-glow));
            color: var(--bg-dark);
            box-shadow: 0 10px 30px rgba(0, 245, 255, 0.3);
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(0, 245, 255, 0.4);
        }

        .welcome-benefits {
            margin-top: 30px;
            padding: 25px;
            background: rgba(0, 255, 136, 0.05);
            border: 1px solid rgba(0, 255, 136, 0.2);
            border-radius: 15px;
            text-align: center;
        }

        .welcome-benefits h4 {
            color: var(--success-glow);
            margin-bottom: 15px;
            font-family: 'Orbitron', monospace;
        }

        .welcome-benefits p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin: 8px 0;
        }

        /* ä¸»åº”ç”¨ç•Œé¢ */
        .main-app {
            display: none;
            min-height: 100vh;
        }

        .app-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            padding: 20px 40px;
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-glow);
            background: rgba(10, 10, 15, 0.9);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo-section h1 {
            font-family: 'Orbitron', monospace;
            font-size: 1.8rem;
            background: linear-gradient(135deg, var(--primary-glow), var(--secondary-glow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 25px;
        }

        .balance-display {
            padding: 12px 25px;
            background: linear-gradient(135deg, rgba(0, 245, 255, 0.1), rgba(124, 58, 237, 0.1));
            border: 1px solid var(--primary-glow);
            border-radius: 25px;
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
        }

        .balance-display::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 245, 255, 0.2), transparent);
            animation: balanceGlow 3s infinite;
        }

        @keyframes balanceGlow {
            0% { left: -100%; }
            50% { left: 100%; }
            100% { left: -100%; }
        }

        .balance-number {
            color: var(--primary-glow);
            font-size: 1.2rem;
            margin: 0 8px;
        }

        /* ä¾§è¾¹å¯¼èˆª */
        .sidebar {
            position: fixed;
            left: 0;
            top: 90px;
            bottom: 0;
            width: 280px;
            padding: 30px 20px;
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--border-glow);
            background: rgba(10, 10, 15, 0.8);
            z-index: 50;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 18px 25px;
            margin: 8px 0;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            border: 1px solid transparent;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 245, 255, 0.1), transparent);
            transition: left 0.3s;
        }

        .nav-item:hover::before,
        .nav-item.active::before {
            left: 0;
        }

        .nav-item:hover,
        .nav-item.active {
            background: rgba(0, 245, 255, 0.1);
            border-color: var(--primary-glow);
            transform: translateX(10px);
        }

        .nav-item i {
            width: 24px;
            margin-right: 15px;
            color: var(--primary-glow);
            font-size: 1.2rem;
        }

        .nav-item span {
            font-weight: 500;
        }

        /* ä¸»å†…å®¹åŒºåŸŸ */
        .main-content {
            margin-left: 280px;
            margin-top: 90px;
            padding: 40px;
            min-height: calc(100vh - 90px);
        }

        .content-section {
            display: none;
            animation: fadeInUp 0.5s ease-out;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-header {
            margin-bottom: 40px;
        }

        .section-header h2 {
            font-family: 'Orbitron', monospace;
            font-size: 2.2rem;
            background: linear-gradient(135deg, var(--primary-glow), var(--accent-glow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .section-header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* AIå¼€å‘ç•Œé¢ */
        .development-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        .dev-card {
            padding: 35px;
            position: relative;
            transition: all 0.3s ease;
        }

        .dev-card:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.4),
                0 0 40px rgba(0, 245, 255, 0.1);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }

        .card-header i {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-glow), var(--accent-glow));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: var(--bg-dark);
            font-size: 1.2rem;
        }

        .card-header h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.3rem;
            color: var(--text-accent);
        }

        .requirement-input {
            width: 100%;
            min-height: 200px;
            padding: 25px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 245, 255, 0.2);
            border-radius: 15px;
            color: var(--text-primary);
            font-size: 1rem;
            line-height: 1.6;
            resize: vertical;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .requirement-input:focus {
            outline: none;
            border-color: var(--primary-glow);
            box-shadow: 0 0 25px rgba(0, 245, 255, 0.2);
        }

        .cost-display {
            margin: 25px 0;
            padding: 25px;
            background: linear-gradient(135deg, rgba(255, 170, 0, 0.1), rgba(255, 0, 110, 0.1));
            border: 1px solid var(--warning-glow);
            border-radius: 15px;
            position: relative;
        }

        .cost-display::before {
            content: '';
            position: absolute;
            top: -1px;
            left: -1px;
            right: -1px;
            bottom: -1px;
            background: linear-gradient(45deg, var(--warning-glow), var(--secondary-glow));
            border-radius: 15px;
            z-index: -1;
            opacity: 0.5;
        }

        .cost-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .cost-header i {
            color: var(--warning-glow);
            margin-right: 10px;
            font-size: 1.3rem;
        }

        .cost-header h4 {
            font-family: 'Orbitron', monospace;
            color: var(--warning-glow);
        }

        .cost-item {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .cost-item:last-child {
            border-bottom: none;
            font-weight: 600;
            color: var(--text-accent);
        }

        .dev-actions {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .btn-test {
            flex: 1;
            background: linear-gradient(135deg, var(--success-glow), var(--primary-glow));
            color: var(--bg-dark);
        }

        .btn-full {
            flex: 1;
            background: linear-gradient(135deg, var(--warning-glow), var(--secondary-glow));
            color: var(--bg-dark);
        }

        /* è¿›åº¦æ˜¾ç¤º */
        .progress-container {
            margin: 25px 0;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-glow), var(--accent-glow));
            transition: width 0.5s ease;
            width: 0%;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: progressShine 2s infinite;
        }

        @keyframes progressShine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-text {
            font-family: 'Orbitron', monospace;
            color: var(--text-accent);
            font-weight: 600;
        }

        .logs-container {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(0, 245, 255, 0.3);
            border-radius: 15px;
            padding: 20px;
            max-height: 350px;
            overflow-y: auto;
            margin-top: 20px;
        }

        .log-entry {
            margin: 8px 0;
            padding: 12px;
            background: rgba(0, 245, 255, 0.05);
            border-left: 3px solid var(--primary-glow);
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            animation: logSlideIn 0.3s ease-out;
        }

        @keyframes logSlideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .log-timestamp {
            color: var(--text-secondary);
            font-size: 0.8rem;
            margin-top: 5px;
        }

        /* å¿«é€Ÿæ“ä½œæŒ‰é’® */
        .quick-actions {
            display: flex;
            gap: 20px;
            margin: 30px 0;
        }

        .quick-action {
            flex: 1;
            padding: 25px;
            text-align: center;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 245, 255, 0.3);
            background: rgba(0, 245, 255, 0.05);
        }

        .quick-action:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0, 245, 255, 0.2);
            border-color: var(--primary-glow);
        }

        .quick-action i {
            font-size: 2.5rem;
            color: var(--primary-glow);
            margin-bottom: 15px;
            display: block;
        }

        .quick-action h4 {
            color: var(--text-accent);
            margin-bottom: 8px;
            font-family: 'Orbitron', monospace;
        }

        .quick-action p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1200px) {
            .sidebar {
                transform: translateX(-280px);
                transition: transform 0.3s ease;
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .development-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .app-header {
                padding: 15px 20px;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .login-box {
                width: 90%;
                padding: 30px;
            }
            
            .dev-actions {
                flex-direction: column;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 245, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-glow);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* é€šçŸ¥ç³»ç»Ÿ */
        .notification {
            position: fixed;
            top: 120px;
            right: 30px;
            padding: 20px 25px;
            border-radius: 15px;
            color: white;
            z-index: 1000;
            backdrop-filter: blur(20px);
            border: 1px solid;
            animation: notificationSlide 0.4s ease-out;
            max-width: 400px;
        }

        .notification.success {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--success-glow);
        }

        .notification.error {
            background: rgba(255, 0, 110, 0.1);
            border-color: var(--secondary-glow);
        }

        .notification.info {
            background: rgba(0, 245, 255, 0.1);
            border-color: var(--primary-glow);
        }

        @keyframes notificationSlide {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* ç¡®è®¤çŠ¶æ€æ ·å¼ */
        .confirmed-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.2), rgba(0, 245, 255, 0.2));
            border: 1px solid var(--success-glow);
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--success-glow);
            margin-left: 15px;
        }

        .confirmed-indicator i {
            color: var(--success-glow);
        }

        /* éšè—ç±» */
        .hidden {
            display: none !important;
        }

        /* çŠ¶æ€æŒ‡ç¤ºå™¨ */
        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-pending { background: var(--warning-glow); }
        .status-processing { background: var(--primary-glow); animation: pulse 1.5s infinite; }
        .status-completed { background: var(--success-glow); }
        .status-error { background: var(--secondary-glow); }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
    </style>
</head>
<body>
    <!-- ç™»å½•ç•Œé¢ -->
    <div id="loginContainer" class="login-container">
        <div class="login-box glass-intense">
            <div class="login-header">
                <h1><i class="fas fa-robot"></i> AI-NEXUS</h1>
                <p>æœªæ¥ç§‘æŠ€é©±åŠ¨çš„æ™ºèƒ½å¼€å‘å¹³å°</p>
            </div>
            
            <div class="input-group">
                <label>ç”¨æˆ·æ ‡è¯†</label>
                <input type="text" id="usernameInput" placeholder="è¾“å…¥æ‚¨çš„ç”¨æˆ·å" required>
            </div>
            
            <div class="input-group">
                <label>è”ç³»é‚®ç®±</label>
                <input type="email" id="emailInput" placeholder="é‚®ç®±åœ°å€ï¼ˆå¯é€‰ï¼‰">
            </div>
            
            <div class="input-group">
                <label>é‚€è¯·å¯†é’¥</label>
                <input type="text" id="inviterCodeInput" placeholder="æœ‹å‹é‚€è¯·ç ï¼ˆå¯é€‰ï¼‰">
            </div>
            
            <button class="btn btn-primary" onclick="login()">
                <i class="fas fa-sign-in-alt"></i> è¿æ¥ç³»ç»Ÿ
            </button>
            
            <div class="welcome-benefits">
                <h4>ğŸš€ æ–°ç”¨æˆ·ä¸“äº«ç‰¹æƒ</h4>
                <p>ğŸ 30ä¸ªAPIé…é¢ç«‹å³åˆ°è´¦</p>
                <p>ğŸ†“ ä¸€æ¬¡å®Œæ•´å…è´¹å¼€å‘ä½“éªŒ</p>
                <p>ğŸ’° é¦–æ¬¡å……å€¼äº«å—50%æŠ˜æ‰£</p>
                <p>ğŸ¤– å°–ç«¯AIæŠ€æœ¯æ— é™å¯èƒ½</p>
            </div>
        </div>
    </div>

    <!-- ä¸»åº”ç”¨ç•Œé¢ -->
    <div id="mainApp" class="main-app">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <header class="app-header">
            <div class="header-content">
                <div class="logo-section">
                    <h1><i class="fas fa-cube"></i> AI-NEXUS</h1>
                </div>
                <div class="user-section">
                    <div class="balance-display">
                        <i class="fas fa-bolt"></i>
                        APIé…é¢
                        <span id="apiBalance" class="balance-number">30</span>
                        <i class="fas fa-coins"></i>
                    </div>
                    <button class="btn" onclick="logout()" style="padding: 10px 20px; background: rgba(255,0,110,0.2); border: 1px solid var(--secondary-glow);">
                        <i class="fas fa-power-off"></i> æ–­å¼€
                    </button>
                </div>
            </div>
        </header>

        <!-- ä¾§è¾¹å¯¼èˆª -->
        <nav class="sidebar">
            <div class="nav-item active" onclick="switchSection('develop')">
                <i class="fas fa-brain"></i>
                <span>AIæ™ºèƒ½å¼€å‘</span>
            </div>
            <div class="nav-item" onclick="switchSection('projects')">
                <i class="fas fa-project-diagram"></i>
                <span>é¡¹ç›®ç®¡æ§ä¸­å¿ƒ</span>
            </div>
            <div class="nav-item" onclick="switchSection('recharge')">
                <i class="fas fa-bolt"></i>
                <span>èƒ½é‡å……å€¼ç«™</span>
            </div>
            <div class="nav-item" onclick="switchSection('share')">
                <i class="fas fa-share-nodes"></i>
                <span>ç—…æ¯’å¼æ¨å¹¿</span>
            </div>
            <div class="nav-item" onclick="switchSection('vip')">
                <i class="fas fa-crown"></i>
                <span>VIPä¼šå‘˜ä¸­å¿ƒ</span>
            </div>
            <div class="nav-item" onclick="switchSection('blockchain')">
                <i class="fas fa-cubes"></i>
                <span>åŒºå—é“¾ä¸­å¿ƒ</span>
            </div>
            <div class="nav-item" onclick="switchSection('analytics')">
                <i class="fas fa-chart-line"></i>
                <span>æ•°æ®åˆ†æå°</span>
            </div>
        </nav>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <!-- AIå¼€å‘åŒºåŸŸ -->
            <section id="develop" class="content-section active">
                <div class="section-header">
                    <h2>AIæ™ºèƒ½å¼€å‘å®éªŒå®¤</h2>
                    <p>åˆ©ç”¨å¤šé‡AIåä½œï¼Œä»æƒ³æ³•åˆ°äº§å“çš„å®Œæ•´è‡ªåŠ¨åŒ–å¼€å‘æµç¨‹</p>
                </div>

                <div class="development-grid">
                    <!-- éœ€æ±‚è¾“å…¥åŒºåŸŸ -->
                    <div class="dev-card glass-intense">
                        <div class="card-header">
                            <i class="fas fa-edit"></i>
                            <h3>é¡¹ç›®éœ€æ±‚å®šä¹‰</h3>
                        </div>
                        
                        <textarea id="requirementInput" class="requirement-input" 
                                  placeholder="ğŸš€ æè¿°æ‚¨çš„é¡¹ç›®æ„¿æ™¯...

ç¤ºä¾‹ï¼šåˆ›å»ºä¸€ä¸ªæœªæ¥æ„Ÿåè¶³çš„ç¤¾äº¤å¹³å°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ ¸å¿ƒåŠŸèƒ½çŸ©é˜µï¼š
â€¢ ğŸ” é‡å­çº§ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
â€¢ ğŸ‘¤ å…¨æ¯ä¸ªäººèµ„æ–™ç®¡ç† 
â€¢ ğŸ“¢ æ™ºèƒ½åŠ¨æ€å‘å¸ƒå¼•æ“
â€¢ ğŸ¤ AIæ¨èç¤¾äº¤ç½‘ç»œ
â€¢ â¤ï¸ æƒ…æ„Ÿåˆ†æäº’åŠ¨ç³»ç»Ÿ
â€¢ ğŸ’¬ å®æ—¶å…¨æ¯é€šè®¯
â€¢ ğŸ” ç¥ç»ç½‘ç»œæœç´¢ç®—æ³•
â€¢ ğŸ”¥ AIç­–å±•çƒ­é—¨å†…å®¹

æŠ€æœ¯æŒ‡æ ‡è¦æ±‚ï¼š
â€¢ å‰ç«¯ï¼šReact + å…¨æ¯UIç•Œé¢
â€¢ åç«¯ï¼šPython FastAPI + å¾®æœåŠ¡æ¶æ„  
â€¢ æ•°æ®åº“ï¼šPostgreSQL + Redisç¼“å­˜
â€¢ éƒ¨ç½²ï¼šKubernetes + å®¹å™¨ç¼–æ’
â€¢ AIé›†æˆï¼šGPT-4 + è®¡ç®—æœºè§†è§‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
è®©AIä¸ºæ‚¨æ„å»ºå®Œæ•´çš„æœªæ¥åº”ç”¨ï¼"></textarea>

                        <div class="cost-display">
                            <div class="cost-header">
                                <i class="fas fa-calculator"></i>
                                <h4>èƒ½é‡æ¶ˆè€—é¢„ä¼°</h4>
                            </div>
                            <div id="costBreakdown">
                                <div class="cost-item">
                                    <span>ğŸ†“ å…è´¹ä½“éªŒæ¨¡å¼</span>
                                    <span id="freeTestStatus">å¯ç”¨</span>
                                </div>
                                <div class="cost-item">
                                    <span>âš¡ å¿«é€Ÿæµ‹è¯•æ¨¡å¼</span>
                                    <span>1 APIé…é¢</span>
                                </div>
                                <div class="cost-item">
                                    <span>ğŸš€ å®Œæ•´å¼€å‘æ¨¡å¼</span>
                                    <span>30 APIé…é¢</span>
                                </div>
                                <div class="cost-item">
                                    <span>å½“å‰é…é¢ä½™é¢</span>
                                    <span id="currentBalance">30</span>
                                </div>
                            </div>
                        </div>

                        <div class="dev-actions">
                            <button id="testBtn" class="btn btn-test" onclick="startAIDevelopment(true)">
                                <i class="fas fa-flask"></i> å¿«é€ŸéªŒè¯
                            </button>
                            <button id="fullBtn" class="btn btn-full" onclick="startAIDevelopment(false)">
                                <i class="fas fa-rocket"></i> å®Œæ•´å¼€å‘
                            </button>
                        </div>
                    </div>

                    <!-- è¿›åº¦ç›‘æ§åŒºåŸŸ -->
                    <div class="dev-card glass-intense">
                        <div class="card-header">
                            <i class="fas fa-tachometer-alt"></i>
                            <h3>å¼€å‘è¿›åº¦ç›‘æ§</h3>
                        </div>
                        
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div id="progressFill" class="progress-fill"></div>
                            </div>
                            <div id="progressText" class="progress-text">ç³»ç»Ÿå¾…å‘½ä¸­...</div>
                        </div>

                        <div class="logs-container">
                            <div id="aiLogs">
                                <div class="log-entry">
                                    <strong>[ç³»ç»Ÿ]</strong> AIåä½œå¼€å‘å¹³å°å·²å°±ç»ª
                                    <div class="log-timestamp">ç­‰å¾…ç”¨æˆ·æŒ‡ä»¤...</div>
                                </div>
                            </div>
                        </div>

                        <!-- å¿«é€Ÿæ“ä½œ -->
                        <div class="quick-actions">
                            <div class="quick-action" onclick="openDocumentViewer()">
                                <i class="fas fa-file-code"></i>
                                <h4>æ–‡æ¡£å®¡æŸ¥</h4>
                                <p>æ™ºèƒ½æ–‡æ¡£ç”Ÿæˆ</p>
                            </div>
                            <div class="quick-action" onclick="openFrontendEditor()">
                                <i class="fas fa-palette"></i>
                                <h4>ç•Œé¢è®¾è®¡</h4>
                                <p>å¯è§†åŒ–ç¼–è¾‘å™¨</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- é¡¹ç›®ç®¡ç†åŒºåŸŸ -->
            <section id="projects" class="content-section">
                <div class="section-header">
                    <h2>é¡¹ç›®ç®¡æ§ä¸­å¿ƒ</h2>
                    <p>å®æ—¶ç›‘æ§æ‰€æœ‰é¡¹ç›®çŠ¶æ€ï¼Œç®¡ç†éƒ¨ç½²å’Œç‰ˆæœ¬</p>
                </div>
                
                <div id="projectsList" class="glass-intense" style="padding: 30px; margin-top: 20px;">
                    <div style="text-align: center; color: var(--text-secondary);">
                        <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 15px;"></i>
                        <p>æ­£åœ¨åŒæ­¥é¡¹ç›®æ•°æ®...</p>
                    </div>
                </div>
            </section>

            <!-- å……å€¼ä¸­å¿ƒåŒºåŸŸ -->
            <section id="recharge" class="content-section">
                <div class="section-header">
                    <h2>èƒ½é‡å……å€¼ç«™</h2>
                    <p>ä¸ºæ‚¨çš„AIå¼€å‘ä¹‹æ—…å……ç”µï¼Œè§£é”æ— é™å¯èƒ½</p>
                </div>
                
                <div id="discountBanner" class="cost-display hidden">
                    <div class="cost-header">
                        <i class="fas fa-fire"></i>
                        <h4>ğŸ‰ æ–°ç”¨æˆ·ä¸“äº«ï¼šé¦–å……åŠä»·ç‰¹æƒï¼</h4>
                    </div>
                    <p style="color: var(--success-glow); font-size: 1.1rem;">é™æ—¶ä¼˜æƒ ï¼Œæ‰€æœ‰èƒ½é‡åŒ…å‡äº«å—50%è¶…çº§æŠ˜æ‰£</p>
                </div>
                
                <div class="development-grid" style="margin-top: 30px;">
                    <!-- èƒ½é‡åŒ…é€‰æ‹© -->
                    <div id="rechargePlans" class="glass-intense" style="padding: 30px;">
                        <h3 style="color: var(--text-accent); margin-bottom: 25px; font-family: 'Orbitron', monospace;">èƒ½é‡åŒ…å¥—é¤</h3>
                        <!-- å……å€¼å¥—é¤å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    
                    <!-- æ”¯ä»˜ç•Œé¢ -->
                    <div class="glass-intense" style="padding: 30px;">
                        <h3 style="color: var(--text-accent); margin-bottom: 25px; font-family: 'Orbitron', monospace;">æ”¯ä»˜ç»ˆç«¯</h3>
                        
                        <div id="selectedPlanInfo" class="hidden" style="margin-bottom: 25px; padding: 20px; background: rgba(0,245,255,0.1); border-radius: 15px;">
                            <h4 style="color: var(--primary-glow);">å·²é€‰æ‹©å¥—é¤</h4>
                            <div id="planDetails"></div>
                        </div>

                        <div id="paymentMethods" class="hidden">
                            <div style="display: flex; gap: 15px; margin: 20px 0;">
                                <button class="btn" onclick="processPayment('wechat')" style="flex: 1; background: linear-gradient(135deg, #07c160, #00d976);">
                                    <i class="fab fa-weixin"></i> å¾®ä¿¡æ”¯ä»˜
                                </button>
                                <button class="btn" onclick="processPayment('alipay')" style="flex: 1; background: linear-gradient(135deg, #1677ff, #69c0ff);">
                                    <i class="fab fa-alipay"></i> æ”¯ä»˜å®
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- æ¨å¹¿åˆ†äº«åŒºåŸŸ -->
            <section id="share" class="content-section">
                <div class="section-header">
                    <h2>ç—…æ¯’å¼æ¨å¹¿ç³»ç»Ÿ</h2>
                    <p>åˆ†äº«åˆ›é€ ä»·å€¼ï¼Œæ¯æ¬¡æ¨å¹¿éƒ½èƒ½è·å¾—ä¸°åšå¥–åŠ±</p>
                </div>
                
                <div class="development-grid">
                    <!-- é‚€è¯·ç å±•ç¤º -->
                    <div class="glass-intense" style="padding: 40px; text-align: center;">
                        <h3 style="color: var(--text-accent); margin-bottom: 25px; font-family: 'Orbitron', monospace;">
                            <i class="fas fa-key"></i> ä¸“å±é‚€è¯·å¯†é’¥
                        </h3>
                        
                        <div style="background: rgba(0,0,0,0.4); padding: 30px; border-radius: 20px; margin: 25px 0; border: 1px solid var(--primary-glow);">
                            <div style="font-family: 'Orbitron', monospace; font-size: 2.5rem; font-weight: 900; color: var(--primary-glow); margin-bottom: 15px; letter-spacing: 3px;">
                                <span id="invitationCode">åŠ è½½ä¸­...</span>
                            </div>
                            <button class="btn btn-primary" onclick="copyInvitationCode()" style="margin-top: 15px;">
                                <i class="fas fa-copy"></i> å¤åˆ¶å¯†é’¥
                            </button>
                        </div>
                        
                        <div class="cost-display" style="margin-top: 25px;">
                            <div class="cost-header">
                                <i class="fas fa-gift"></i>
                                <h4>å¥–åŠ±æœºåˆ¶</h4>
                            </div>
                            <div class="cost-item">
                                <span>å¥½å‹æ³¨å†ŒæˆåŠŸ</span>
                                <span style="color: var(--success-glow);">+30 é…é¢</span>
                            </div>
                            <div class="cost-item">
                                <span>å¥½å‹å……å€¼å¥–åŠ±</span>
                                <span style="color: var(--success-glow);">+15% é…é¢</span>
                            </div>
                            <div class="cost-item">
                                <span>åˆ†äº«å¹³å°å¥–åŠ±</span>
                                <span style="color: var(--success-glow);">+5 é…é¢</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- åˆ†äº«ç»Ÿè®¡ -->
                    <div class="glass-intense" style="padding: 40px;">
                        <h3 style="color: var(--text-accent); margin-bottom: 25px; font-family: 'Orbitron', monospace;">
                            <i class="fas fa-chart-line"></i> æ¨å¹¿æˆ˜ç»©
                        </h3>
                        
                        <div id="shareStats">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                                <div style="text-align: center; padding: 20px; background: rgba(0,255,136,0.1); border-radius: 15px;">
                                    <div style="font-size: 2rem; font-weight: bold; color: var(--success-glow);" id="totalInvitations">0</div>
                                    <div style="color: var(--text-secondary);">æˆåŠŸé‚€è¯·</div>
                                </div>
                                <div style="text-align: center; padding: 20px; background: rgba(0,245,255,0.1); border-radius: 15px;">
                                    <div style="font-size: 2rem; font-weight: bold; color: var(--primary-glow);" id="totalRewards">0</div>
                                    <div style="color: var(--text-secondary);">ç´¯è®¡å¥–åŠ±</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="text-align: center;">
                            <h4 style="color: var(--text-accent); margin-bottom: 20px;">å¿«é€Ÿåˆ†äº«</h4>
                            <div style="display: flex; gap: 15px;">
                                <button class="btn" onclick="shareToWeChat()" style="flex: 1; background: linear-gradient(135deg, #07c160, #00d976);">
                                    <i class="fab fa-weixin"></i> å¾®ä¿¡
                                </button>
                                <button class="btn" onclick="shareToWeibo()" style="flex: 1; background: linear-gradient(135deg, #e6162d, #ff6b6b);">
                                    <i class="fab fa-weibo"></i> å¾®åš
                                </button>
                                <button class="btn" onclick="shareToQQ()" style="flex: 1; background: linear-gradient(135deg, #12b7f5, #1890ff);">
                                    <i class="fab fa-qq"></i> QQç©ºé—´
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- VIPä¼šå‘˜ä¸­å¿ƒ -->
            <section id="vip" class="content-section">
                <div class="section-header">
                    <h2><i class="fas fa-crown"></i> VIPä¼šå‘˜ä¸­å¿ƒ</h2>
                    <p>ä¸“äº«ç‰¹æƒï¼Œè§£é”æ— é™å¯èƒ½</p>
                </div>
                
                <!-- å½“å‰VIPçŠ¶æ€ -->
                <div id="vipStatus" class="glass-intense" style="padding: 40px; margin-bottom: 30px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                        <div>
                            <h3 style="color: var(--text-accent); font-family: 'Orbitron', monospace;">
                                <i class="fas fa-user-crown"></i> å½“å‰ç­‰çº§ï¼š<span id="currentVipLevel">å¸¸è§„ä¼šå‘˜</span>
                            </h3>
                            <p id="vipExpires" style="color: var(--text-secondary); margin-top: 5px;">äº«å—åŸºç¡€AIå¼€å‘æœåŠ¡</p>
                        </div>
                        <div id="vipBadge" style="text-align: center;">
                            <div style="width: 80px; height: 80px; border-radius: 50%; background: var(--text-secondary); display: flex; align-items: center; justify-content: center; font-size: 2rem; color: white;">
                                <i class="fas fa-user"></i>
                            </div>
                        </div>
                    </div>
                    
                    <div id="vipBenefits" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <!-- VIPæƒç›Šå°†é€šè¿‡JavaScriptåŠ¨æ€å¡«å…… -->
                    </div>
                </div>

                <!-- VIPå¥—é¤é€‰æ‹© -->
                <div class="development-grid">
                    <!-- é«˜çº§ä¼šå‘˜ -->
                    <div class="glass-intense vip-plan" style="padding: 40px; position: relative; border: 2px solid #FFD700;">
                        <div style="position: absolute; top: -15px; left: 50%; transform: translateX(-50%); background: #FFD700; color: #000; padding: 8px 20px; border-radius: 20px; font-weight: bold; font-size: 0.9rem;">
                            <i class="fas fa-star"></i> æ¨è
                        </div>
                        
                        <div style="text-align: center; margin-bottom: 30px;">
                            <div style="width: 100px; height: 100px; margin: 0 auto 20px; border-radius: 50%; background: linear-gradient(135deg, #FFD700, #FFA500); display: flex; align-items: center; justify-content: center; font-size: 3rem; color: #000;">
                                <i class="fas fa-crown"></i>
                            </div>
                            <h3 style="color: #FFD700; font-family: 'Orbitron', monospace; font-size: 1.8rem; margin-bottom: 10px;">é«˜çº§ä¼šå‘˜</h3>
                            <div style="font-size: 2.5rem; font-weight: bold; color: #FFD700; margin-bottom: 5px;">ï¿¥100<span style="font-size: 1rem; color: var(--text-secondary);">/æœˆ</span></div>
                            <p style="color: var(--text-secondary);">æœˆèµ 200é…é¢</p>
                        </div>

                        <div style="margin-bottom: 30px;">
                            <h4 style="color: var(--text-accent); margin-bottom: 15px; text-align: center;">ä¸“äº«ç‰¹æƒ</h4>
                            <ul style="list-style: none; padding: 0;">
                                <li style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-check" style="color: #FFD700;"></i>
                                    <span>å…è´¹ä¸€é”®ä¸Šäº‘éƒ¨ç½²</span>
                                </li>
                                <li style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-check" style="color: #FFD700;"></i>
                                    <span>å…è´¹ä¸€é”®ä¸Šé“¾æœåŠ¡</span>
                                </li>
                                <li style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-check" style="color: #FFD700;"></i>
                                    <span>æ¯æœˆèµ é€200é…é¢</span>
                                </li>
                                <li style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-check" style="color: #FFD700;"></i>
                                    <span>ä½£é‡‘ç‡æå‡5%</span>
                                </li>
                                <li style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-check" style="color: #FFD700;"></i>
                                    <span>VIPä¸“å±åˆ†äº«é“¾æ¥</span>
                                </li>
                                <li style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-check" style="color: #FFD700;"></i>
                                    <span>é‚€è¯·ç”¨æˆ·é¢å¤–+20é…é¢</span>
                                </li>
                            </ul>
                        </div>

                        <button class="btn" onclick="upgradeVIP(1)" style="width: 100%; background: linear-gradient(135deg, #FFD700, #FFA500); color: #000; font-weight: bold; padding: 15px;">
                            <i class="fas fa-crown"></i> ç«‹å³å‡çº§
                        </button>
                    </div>

                    <!-- è‡³å°Šä¼šå‘˜ -->
                    <div class="glass-intense vip-plan" style="padding: 40px; position: relative; border: 2px solid #8A2BE2;">
                        <div style="position: absolute; top: -15px; left: 50%; transform: translateX(-50%); background: #8A2BE2; color: #fff; padding: 8px 20px; border-radius: 20px; font-weight: bold; font-size: 0.9rem;">
                            <i class="fas fa-diamond"></i> è‡³å°Š
                        </div>
                        
                        <div style="text-align: center; margin-bottom: 30px;">
                            <div style="width: 100px; height: 100px; margin: 0 auto 20px; border-radius: 50%; background: linear-gradient(135deg, #8A2BE2, #9370DB); display: flex; align-items: center; justify-content: center; font-size: 3rem; color: #fff; position: relative;">
                                <i class="fas fa-gem"></i>
                                <div style="position: absolute; inset: -5px; border-radius: 50%; background: conic-gradient(#8A2BE2, #9370DB, #DDA0DD, #8A2BE2); animation: rotate 3s linear infinite; z-index: -1;"></div>
                            </div>
                            <h3 style="color: #8A2BE2; font-family: 'Orbitron', monospace; font-size: 1.8rem; margin-bottom: 10px;">è‡³å°Šä¼šå‘˜</h3>
                            <div style="font-size: 2.5rem; font-weight: bold; color: #8A2BE2; margin-bottom: 5px;">ï¿¥1000<span style="font-size: 1rem; color: var(--text-secondary);">/æœˆ</span></div>
                            <p style="color: var(--text-secondary);">æœˆèµ 2000é…é¢</p>
                        </div>

                        <div style="margin-bottom: 30px;">
                            <h4 style="color: var(--text-accent); margin-bottom: 15px; text-align: center;">è‡³å°Šç‰¹æƒ</h4>
                            <ul style="list-style: none; padding: 0;">
                                <li style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-check" style="color: #8A2BE2;"></i>
                                    <span>é«˜çº§ä¼šå‘˜æ‰€æœ‰æƒç›Š</span>
                                </li>
                                <li style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-check" style="color: #8A2BE2;"></i>
                                    <span>æ‰€æœ‰åŠŸèƒ½äº«å—åŠä»·</span>
                                </li>
                                <li style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-check" style="color: #8A2BE2;"></i>
                                    <span>ç‰¹æ®Šè¦æ±‚å®šåˆ¶éƒ¨ç½²</span>
                                </li>
                                <li style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-check" style="color: #8A2BE2;"></i>
                                    <span>æ¯æœˆèµ é€2000é…é¢</span>
                                </li>
                                <li style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-check" style="color: #8A2BE2;"></i>
                                    <span>ä¸“å±å®¢æœæ”¯æŒ</span>
                                </li>
                                <li style="margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                                    <i class="fas fa-check" style="color: #8A2BE2;"></i>
                                    <span>ä¼˜å…ˆæŠ€æœ¯æ”¯æŒ</span>
                                </li>
                            </ul>
                        </div>

                        <button class="btn" onclick="upgradeVIP(2)" style="width: 100%; background: linear-gradient(135deg, #8A2BE2, #9370DB); color: #fff; font-weight: bold; padding: 15px;">
                            <i class="fas fa-gem"></i> ç«‹å³å‡çº§
                        </button>
                    </div>
                </div>

                <!-- VIPè®°å½• -->
                <div class="glass-intense" style="padding: 30px; margin-top: 30px;">
                    <h3 style="color: var(--text-accent); margin-bottom: 20px; font-family: 'Orbitron', monospace;">
                        <i class="fas fa-history"></i> VIPè®°å½•
                    </h3>
                    <div id="vipRecords" style="min-height: 200px;">
                        <div style="text-align: center; color: var(--text-secondary); padding: 60px 20px;">
                            <i class="fas fa-list" style="font-size: 2rem; margin-bottom: 15px; opacity: 0.5;"></i>
                            <p>æš‚æ— VIPè®°å½•</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- åŒºå—é“¾ä¸­å¿ƒ -->
            <section id="blockchain" class="content-section">
                <div class="section-header">
                    <h2><i class="fas fa-cubes"></i> åŒºå—é“¾æ•°æ®ä¸­å¿ƒ</h2>
                    <p>ç®¡ç†æ‚¨çš„é“¾ä¸Šæ•°æ®å’Œæ•°å­—èµ„äº§</p>
                </div>
                
                <!-- åŒºå—é“¾ç»Ÿè®¡ -->
                <div class="development-grid" style="margin-bottom: 30px;">
                    <div class="glass-intense" style="padding: 30px; text-align: center;">
                        <div style="font-size: 2.5rem; color: var(--primary-glow); margin-bottom: 10px;">
                            <i class="fas fa-project-diagram"></i>
                        </div>
                        <h3 style="color: var(--text-accent); margin-bottom: 5px;">ä¸Šé“¾é¡¹ç›®</h3>
                        <div id="blockchainProjectCount" style="font-size: 1.8rem; font-weight: bold; color: var(--primary-glow);">0</div>
                    </div>
                    
                    <div class="glass-intense" style="padding: 30px; text-align: center;">
                        <div style="font-size: 2.5rem; color: var(--accent-glow); margin-bottom: 10px;">
                            <i class="fas fa-file-contract"></i>
                        </div>
                        <h3 style="color: var(--text-accent); margin-bottom: 5px;">æ™ºèƒ½åˆçº¦</h3>
                        <div id="smartContractCount" style="font-size: 1.8rem; font-weight: bold; color: var(--accent-glow);">0</div>
                    </div>
                    
                    <div class="glass-intense" style="padding: 30px; text-align: center;">
                        <div style="font-size: 2.5rem; color: var(--warning-glow); margin-bottom: 10px;">
                            <i class="fas fa-gas-pump"></i>
                        </div>
                        <h3 style="color: var(--text-accent); margin-bottom: 5px;">Gasæ¶ˆè€—</h3>
                        <div id="totalGasUsed" style="font-size: 1.8rem; font-weight: bold; color: var(--warning-glow);">0</div>
                    </div>
                </div>

                <!-- å¿«é€Ÿæ“ä½œ -->
                <div class="glass-intense" style="padding: 30px; margin-bottom: 30px;">
                    <h3 style="color: var(--text-accent); margin-bottom: 20px; font-family: 'Orbitron', monospace;">
                        <i class="fas fa-rocket"></i> å¿«é€Ÿä¸Šé“¾
                    </h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <button class="btn" onclick="createRealBlockchainWallet()" style="background: var(--success-glow); color: var(--bg-dark); padding: 20px; height: auto; flex-direction: column; gap: 10px;">
                            <i class="fas fa-wallet" style="font-size: 1.5rem;"></i>
                            <div>
                                <div style="font-weight: bold;">åˆ›å»ºåŒºå—é“¾é’±åŒ…</div>
                                <div style="font-size: 0.8rem; opacity: 0.8;">å…è´¹ - çœŸå®é’±åŒ…</div>
                            </div>
                        </button>
                        
                        <button class="btn" onclick="deployUserProfileToRealBlockchain()" style="background: var(--primary-glow); color: var(--bg-dark); padding: 20px; height: auto; flex-direction: column; gap: 10px;">
                            <i class="fas fa-user" style="font-size: 1.5rem;"></i>
                            <div>
                                <div style="font-weight: bold;">ç”¨æˆ·æ¡£æ¡ˆçœŸå®ä¸Šé“¾</div>
                                <div style="font-size: 0.8rem; opacity: 0.8;">15é…é¢ - æ°¸ä¹…å­˜å‚¨</div>
                            </div>
                        </button>
                        
                        <button class="btn" onclick="showWalletDetails()" style="background: var(--accent-glow); color: var(--bg-dark); padding: 20px; height: auto; flex-direction: column; gap: 10px;">
                            <i class="fas fa-eye" style="font-size: 1.5rem;"></i>
                            <div>
                                <div style="font-weight: bold;">æŸ¥çœ‹é’±åŒ…è¯¦æƒ…</div>
                                <div style="font-size: 0.8rem; opacity: 0.8;">å®æ—¶ä½™é¢æŸ¥è¯¢</div>
                            </div>
                        </button>
                    </div>
                    
                    <!-- ç½‘ç»œé€‰æ‹© -->
                    <div style="margin-top: 20px; padding: 20px; background: rgba(0,0,0,0.2); border-radius: 10px;">
                        <h4 style="color: var(--text-accent); margin-bottom: 15px;">é€‰æ‹©åŒºå—é“¾ç½‘ç»œ</h4>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="blockchain_network" value="solana-devnet" checked>
                                <span style="color: var(--success-glow);">Solanaå¼€å‘ç½‘ (æ¨è)</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="blockchain_network" value="ethereum">
                                <span style="color: var(--primary-glow);">ä»¥å¤ªåŠä¸»ç½‘</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="radio" name="blockchain_network" value="polygon">
                                <span style="color: var(--accent-glow);">Polygonç½‘ç»œ</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- åŒºå—é“¾è®°å½• -->
                <div class="glass-intense" style="padding: 30px; margin-bottom: 30px;">
                    <h3 style="color: var(--text-accent); margin-bottom: 20px; font-family: 'Orbitron', monospace;">
                        <i class="fas fa-history"></i> åŒºå—é“¾è®°å½•
                    </h3>
                    <div id="blockchainRecords" style="min-height: 300px;">
                        <div style="text-align: center; color: var(--text-secondary); padding: 60px 20px;">
                            <i class="fas fa-cube" style="font-size: 2rem; margin-bottom: 15px; opacity: 0.5;"></i>
                            <p>æš‚æ— åŒºå—é“¾è®°å½•</p>
                        </div>
                    </div>
                </div>

                <!-- æ™ºèƒ½åˆçº¦ -->
                <div class="glass-intense" style="padding: 30px;">
                    <h3 style="color: var(--text-accent); margin-bottom: 20px; font-family: 'Orbitron', monospace;">
                        <i class="fas fa-file-contract"></i> æˆ‘çš„æ™ºèƒ½åˆçº¦
                    </h3>
                    <div id="smartContracts" style="min-height: 300px;">
                        <div style="text-align: center; color: var(--text-secondary); padding: 60px 20px;">
                            <i class="fas fa-file-contract" style="font-size: 2rem; margin-bottom: 15px; opacity: 0.5;"></i>
                            <p>æš‚æ— æ™ºèƒ½åˆçº¦</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- æ•°æ®åˆ†æåŒºåŸŸ -->
            <section id="analytics" class="content-section">
                <div class="section-header">
                    <h2><i class="fas fa-chart-line"></i> æ•°æ®åˆ†æå°</h2>
                    <p>æ·±åº¦æ´å¯Ÿæ‚¨çš„ä½¿ç”¨æ•°æ®å’Œæˆé•¿è½¨è¿¹</p>
                </div>
                
                <!-- æ ¸å¿ƒæŒ‡æ ‡ -->
                <div class="development-grid" style="margin-bottom: 30px;">
                    <div class="glass-intense" style="padding: 30px; text-align: center;">
                        <div style="font-size: 2.5rem; color: var(--primary-glow); margin-bottom: 10px;">
                            <i class="fas fa-project-diagram"></i>
                        </div>
                        <h3 style="color: var(--text-accent); margin-bottom: 5px;">æ€»é¡¹ç›®æ•°</h3>
                        <div id="analyticsProjectCount" style="font-size: 1.8rem; font-weight: bold; color: var(--primary-glow);">0</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 5px;">
                            å®Œæˆç‡: <span id="projectCompletionRate">0%</span>
                        </div>
                    </div>
                    
                    <div class="glass-intense" style="padding: 30px; text-align: center;">
                        <div style="font-size: 2.5rem; color: var(--accent-glow); margin-bottom: 10px;">
                            <i class="fas fa-coins"></i>
                        </div>
                        <h3 style="color: var(--text-accent); margin-bottom: 5px;">é…é¢ä½¿ç”¨</h3>
                        <div id="analyticsQuotaUsed" style="font-size: 1.8rem; font-weight: bold; color: var(--accent-glow);">0</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 5px;">
                            å‰©ä½™: <span id="quotaRemaining">0</span>
                        </div>
                    </div>
                    
                    <div class="glass-intense" style="padding: 30px; text-align: center;">
                        <div style="font-size: 2.5rem; color: var(--success-glow); margin-bottom: 10px;">
                            <i class="fas fa-users"></i>
                        </div>
                        <h3 style="color: var(--text-accent); margin-bottom: 5px;">é‚€è¯·ç”¨æˆ·</h3>
                        <div id="analyticsInvitations" style="font-size: 1.8rem; font-weight: bold; color: var(--success-glow);">0</div>
                        <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 5px;">
                            å¥–åŠ±: <span id="invitationRewards">0</span>é…é¢
                        </div>
                    </div>
                </div>

                <!-- å›¾è¡¨åŒºåŸŸ -->
                <div class="development-grid" style="margin-bottom: 30px;">
                    <!-- ä½¿ç”¨è¶‹åŠ¿å›¾ -->
                    <div class="glass-intense" style="padding: 30px;">
                        <h3 style="color: var(--text-accent); margin-bottom: 20px; font-family: 'Orbitron', monospace;">
                            <i class="fas fa-chart-area"></i> ä½¿ç”¨è¶‹åŠ¿
                        </h3>
                        <div id="usageTrendChart" style="height: 300px; background: rgba(0,0,0,0.2); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary);">
                            <div style="text-align: center;">
                                <i class="fas fa-chart-line" style="font-size: 2rem; margin-bottom: 10px; opacity: 0.5;"></i>
                                <p>7å¤©é…é¢ä½¿ç”¨è¶‹åŠ¿</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- é¡¹ç›®åˆ†å¸ƒå›¾ -->
                    <div class="glass-intense" style="padding: 30px;">
                        <h3 style="color: var(--text-accent); margin-bottom: 20px; font-family: 'Orbitron', monospace;">
                            <i class="fas fa-chart-pie"></i> é¡¹ç›®çŠ¶æ€åˆ†å¸ƒ
                        </h3>
                        <div id="projectDistributionChart" style="height: 300px; background: rgba(0,0,0,0.2); border-radius: 10px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary);">
                            <div style="text-align: center;">
                                <i class="fas fa-chart-pie" style="font-size: 2rem; margin-bottom: 10px; opacity: 0.5;"></i>
                                <p>é¡¹ç›®çŠ¶æ€ç»Ÿè®¡</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- è¯¦ç»†ç»Ÿè®¡ -->
                <div class="development-grid">
                    <!-- æ”¶æ”¯åˆ†æ -->
                    <div class="glass-intense" style="padding: 30px;">
                        <h3 style="color: var(--text-accent); margin-bottom: 20px; font-family: 'Orbitron', monospace;">
                            <i class="fas fa-wallet"></i> æ”¶æ”¯åˆ†æ
                        </h3>
                        <div id="incomeExpenseAnalysis" style="min-height: 200px;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <div style="text-align: center; padding: 20px; background: rgba(0,255,136,0.1); border-radius: 10px;">
                                    <div style="color: var(--success-glow); font-size: 1.5rem; font-weight: bold;" id="totalIncome">0</div>
                                    <div style="color: var(--text-secondary); font-size: 0.9rem;">æ€»æ”¶å…¥(é…é¢)</div>
                                </div>
                                <div style="text-align: center; padding: 20px; background: rgba(255,107,107,0.1); border-radius: 10px;">
                                    <div style="color: var(--warning-glow); font-size: 1.5rem; font-weight: bold;" id="totalExpense">0</div>
                                    <div style="color: var(--text-secondary); font-size: 0.9rem;">æ€»æ”¯å‡º(é…é¢)</div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 10px;">
                                <h4 style="color: var(--text-accent); margin-bottom: 10px;">æ”¶å…¥æ¥æº</h4>
                                <div id="incomeBreakdown">
                                    <div style="display: flex; justify-content: space-between; margin: 5px 0;">
                                        <span>å……å€¼æ”¶å…¥:</span>
                                        <span id="rechargeIncome">0é…é¢</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin: 5px 0;">
                                        <span>é‚€è¯·å¥–åŠ±:</span>
                                        <span id="inviteIncome">0é…é¢</span>
                                    </div>
                                    <div style="display: flex; justify-content: space-between; margin: 5px 0;">
                                        <span>åˆ†äº«å¥–åŠ±:</span>
                                        <span id="shareIncome">0é…é¢</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å¹³å°æ´»è·ƒåº¦ -->
                    <div class="glass-intense" style="padding: 30px;">
                        <h3 style="color: var(--text-accent); margin-bottom: 20px; font-family: 'Orbitron', monospace;">
                            <i class="fas fa-fire"></i> å¹³å°æ´»è·ƒåº¦
                        </h3>
                        <div id="activityAnalysis" style="min-height: 200px;">
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <span>ç™»å½•å¤©æ•°</span>
                                    <span id="loginDays" style="font-weight: bold; color: var(--primary-glow);">0å¤©</span>
                                </div>
                                <div style="height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden;">
                                    <div id="loginProgress" style="height: 100%; background: var(--primary-glow); width: 0%; transition: width 0.3s ease;"></div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 20px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <span>AIå¼€å‘æ¬¡æ•°</span>
                                    <span id="developmentCount" style="font-weight: bold; color: var(--accent-glow);">0æ¬¡</span>
                                </div>
                                <div style="height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden;">
                                    <div id="developmentProgress" style="height: 100%; background: var(--accent-glow); width: 0%; transition: width 0.3s ease;"></div>
                                </div>
                            </div>
                            
                            <div>
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <span>åˆ†äº«æ´»è·ƒåº¦</span>
                                    <span id="shareActivity" style="font-weight: bold; color: var(--success-glow);">0%</span>
                                </div>
                                <div style="height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden;">
                                    <div id="shareProgress" style="height: 100%; background: var(--success-glow); width: 0%; transition: width 0.3s ease;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æˆé•¿å»ºè®® -->
                <div class="glass-intense" style="padding: 30px; margin-top: 30px;">
                    <h3 style="color: var(--text-accent); margin-bottom: 20px; font-family: 'Orbitron', monospace;">
                        <i class="fas fa-lightbulb"></i> æ™ºèƒ½å»ºè®®
                    </h3>
                    <div id="growthSuggestions" style="min-height: 100px;">
                        <div style="text-align: center; color: var(--text-secondary); padding: 40px 20px;">
                            <i class="fas fa-robot" style="font-size: 2rem; margin-bottom: 15px; opacity: 0.5;"></i>
                            <p>åŸºäºæ‚¨çš„ä½¿ç”¨æ•°æ®ï¼ŒAIæ­£åœ¨ç”Ÿæˆä¸ªæ€§åŒ–å»ºè®®...</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentUserId = null;
        let currentProject = null;
        let selectedPlan = null;
        let ws = null;
        let hasUsedFreeTest = false;
        let isFirstTimeUser = true;
        let userStats = {};
        let userVipInfo = { level: 0, name: "å¸¸è§„ä¼šå‘˜" };

        // é¡µé¢åŠ è½½
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
            initializeRechargeOptions();
        });

        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        function checkLoginStatus() {
            const savedUserId = localStorage.getItem('userId');
            const loginTime = localStorage.getItem('loginTime');
            
            if (savedUserId && loginTime) {
                const daysSinceLogin = (Date.now() - parseInt(loginTime)) / (1000 * 60 * 60 * 24);
                if (daysSinceLogin < 7) {
                    currentUserId = savedUserId;
                    showMainApp();
                    return;
                }
            }
            
            showLoginPage();
        }

        // æ˜¾ç¤ºç™»å½•é¡µé¢
        function showLoginPage() {
            document.getElementById('loginContainer').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
        }

        // æ˜¾ç¤ºä¸»åº”ç”¨
        function showMainApp() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            loadUserData();
            loadProjectsList();
            connectWebSocket();
        }

        // ç™»å½•
        async function login() {
            const username = document.getElementById('usernameInput').value.trim();
            const email = document.getElementById('emailInput').value.trim();
            const inviterCode = document.getElementById('inviterCodeInput').value.trim();

            if (!username) {
                showNotification('è¯·è¾“å…¥ç”¨æˆ·æ ‡è¯†', 'error');
                return;
            }

            try {
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        username: username,
                        email: email,
                        inviter_code: inviterCode
                    })
                });

                const result = await response.json();
                
                if (response.ok) {
                    currentUserId = result.user_id;
                    localStorage.setItem('userId', currentUserId);
                    localStorage.setItem('loginTime', Date.now().toString());
                    
                    showNotification('ç³»ç»Ÿè¿æ¥æˆåŠŸï¼æ¬¢è¿è¿›å…¥AI-NEXUS', 'success');
                    showMainApp();
                } else {
                    showNotification(result.detail || 'è¿æ¥å¤±è´¥', 'error');
                }
            } catch (error) {
                showNotification('ç½‘ç»œè¿æ¥å¼‚å¸¸ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // é€€å‡ºç™»å½•
        function logout() {
            localStorage.removeItem('userId');
            localStorage.removeItem('loginTime');
            currentUserId = null;
            if (ws) ws.close();
            showLoginPage();
            showNotification('ç³»ç»Ÿå·²æ–­å¼€è¿æ¥', 'info');
        }

        // è¿æ¥WebSocket
        function connectWebSocket() {
            if (!currentUserId) return;

            ws = new WebSocket(`ws://localhost:8892/ws?user_id=${currentUserId}`);
            
            ws.onmessage = function(event) {
                const data = JSON.parse(event.data);
                handleWebSocketMessage(data);
            };

            ws.onclose = function() {
                setTimeout(connectWebSocket, 3000);
            };
        }

        // å¤„ç†WebSocketæ¶ˆæ¯
        function handleWebSocketMessage(data) {
            switch(data.type) {
                case 'ai_log':
                    addAILog(data);
                    break;
                case 'project_ready_for_review':
                    handleProjectReady(data);
                    break;
                case 'balance_update':
                    updateBalanceDisplay(data.balance);
                    break;
            }
        }

        // åŠ è½½ç”¨æˆ·æ•°æ®
        async function loadUserData() {
            if (!currentUserId) return;

            try {
                const [statsResponse, invitationResponse] = await Promise.all([
                    fetch(`/api/user-stats/${currentUserId}`),
                    fetch(`/api/invitation-stats/${currentUserId}`)
                ]);
                
                if (statsResponse.ok) {
                    const data = await statsResponse.json();
                    userStats = data;
                    
                    updateBalanceDisplay(data.user.api_balance);
                    isFirstTimeUser = data.user.total_recharge === 0;
                    hasUsedFreeTest = data.projects.total > 0;
                    
                    updateCostDisplay();
                    updateDiscountDisplay();
                }
                
                if (invitationResponse.ok) {
                    const invitationData = await invitationResponse.json();
                    document.getElementById('invitationCode').textContent = invitationData.invitation_code || 'åŠ è½½ä¸­...';
                    document.getElementById('totalInvitations').textContent = invitationData.total_invitations || 0;
                    document.getElementById('totalRewards').textContent = invitationData.total_rewards || 0;
                }
            } catch (error) {
                console.error('åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥:', error);
                showNotification('æ•°æ®åŠ è½½å¤±è´¥', 'error');
            }
        }

        // æ›´æ–°ä½™é¢æ˜¾ç¤º
        function updateBalanceDisplay(balance) {
            document.getElementById('apiBalance').textContent = balance;
            document.getElementById('currentBalance').textContent = balance;
        }

        // æ›´æ–°è´¹ç”¨æ˜¾ç¤º
        function updateCostDisplay() {
            const freeTestStatus = document.getElementById('freeTestStatus');
            if (!hasUsedFreeTest) {
                freeTestStatus.textContent = 'âœ… å¯ç”¨';
                freeTestStatus.style.color = 'var(--success-glow)';
                document.getElementById('testBtn').innerHTML = '<i class="fas fa-gift"></i> å…è´¹ä½“éªŒ';
            } else {
                freeTestStatus.textContent = 'âŒ å·²ä½¿ç”¨';
                freeTestStatus.style.color = 'var(--text-secondary)';
                document.getElementById('testBtn').innerHTML = '<i class="fas fa-flask"></i> å¿«é€ŸéªŒè¯';
            }
        }

        // æ›´æ–°æŠ˜æ‰£æ˜¾ç¤º
        function updateDiscountDisplay() {
            if (isFirstTimeUser) {
                document.getElementById('discountBanner').classList.remove('hidden');
                generateRechargeOptions(true);
            } else {
                generateRechargeOptions(false);
            }
        }

        // ç”Ÿæˆå……å€¼é€‰é¡¹
        function generateRechargeOptions(showDiscount = false) {
            const plans = [
                { id: 'basic', name: 'åŸºç¡€èƒ½é‡åŒ…', price: 50, quota: 100, desc: 'å°å‹é¡¹ç›®æµ‹è¯•ä¸“ç”¨' },
                { id: 'pro', name: 'ä¸“ä¸šèƒ½é‡åŒ…', price: 120, quota: 300, desc: 'ä¸­å‹é¡¹ç›®å¼€å‘é¦–é€‰' },
                { id: 'enterprise', name: 'ä¼ä¸šèƒ½é‡åŒ…', price: 200, quota: 800, desc: 'å¤§å‹é¡¹ç›®å›¢é˜Ÿå¿…å¤‡' }
            ];

            const container = document.getElementById('rechargePlans');
            container.innerHTML = '';

            plans.forEach(plan => {
                const actualPrice = showDiscount ? plan.price * 0.5 : plan.price;
                const planElement = document.createElement('div');
                planElement.className = 'glass';
                planElement.style.cssText = `
                    padding: 25px;
                    margin: 15px 0;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    border: 1px solid rgba(0,245,255,0.3);
                    position: relative;
                `;
                
                planElement.innerHTML = `
                    ${showDiscount ? '<div style="position: absolute; top: -10px; right: -10px; background: var(--secondary-glow); color: white; padding: 5px 12px; border-radius: 15px; font-size: 0.8rem; font-weight: bold;">åŠä»·</div>' : ''}
                    <h4 style="color: var(--text-accent); margin-bottom: 10px; font-family: 'Orbitron', monospace;">${plan.name}</h4>
                    <div style="font-size: 2rem; font-weight: bold; color: var(--primary-glow); margin: 15px 0;">
                        ${showDiscount ? `<span style="text-decoration: line-through; opacity: 0.6; font-size: 1.2rem;">ï¿¥${plan.price}</span><br>` : ''}
                        ï¿¥${actualPrice}
                    </div>
                    <p style="color: var(--success-glow); font-size: 1.1rem; margin: 10px 0;">${plan.quota} APIé…é¢</p>
                    <p style="color: var(--text-secondary); font-size: 0.9rem;">${plan.desc}</p>
                `;
                
                planElement.onclick = () => selectPlan(plan.id, plan.price, plan.quota);
                container.appendChild(planElement);
            });
        }

        // åˆå§‹åŒ–å……å€¼é€‰é¡¹
        function initializeRechargeOptions() {
            generateRechargeOptions(false);
        }

        // åˆ‡æ¢åŒºåŸŸ
        function switchSection(sectionName) {
            // æ›´æ–°å¯¼èˆªçŠ¶æ€
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // æ›´æ–°å†…å®¹åŒºåŸŸ
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionName).classList.add('active');
            
            // ç‰¹æ®Šå¤„ç†
            if (sectionName === 'projects') {
                loadProjectsList();
            } else if (sectionName === 'vip') {
                loadVipInfo();
            } else if (sectionName === 'blockchain') {
                loadBlockchainData();
            } else if (sectionName === 'analytics') {
                loadAnalyticsData();
            }
        }

        // å¯åŠ¨AIå¼€å‘
        async function startAIDevelopment(testMode) {
            const requirement = document.getElementById('requirementInput').value.trim();
            
            if (!requirement) {
                showNotification('è¯·è¾“å…¥é¡¹ç›®éœ€æ±‚æè¿°', 'error');
                return;
            }

            // æ£€æŸ¥é…é¢
            const requiredQuota = testMode ? (hasUsedFreeTest ? 1 : 0) : 50; // å‡çº§é…é¢è¦æ±‚
            const currentBalance = parseInt(document.getElementById('apiBalance').textContent);
            
            if (requiredQuota > 0 && currentBalance < requiredQuota) {
                showNotification(`é…é¢ä¸è¶³ï¼éœ€è¦${requiredQuota}ä¸ªé…é¢ï¼Œè¯·å…ˆå……å€¼`, 'error');
                switchSection('recharge');
                return;
            }

            const testBtn = document.getElementById('testBtn');
            const fullBtn = document.getElementById('fullBtn');
            
            // ç¦ç”¨ä¸¤ä¸ªæŒ‰é’®ï¼Œæ”¹å˜é¢œè‰²
            testBtn.disabled = true;
            fullBtn.disabled = true;
            testBtn.style.opacity = '0.5';
            fullBtn.style.opacity = '0.5';
            testBtn.style.cursor = 'not-allowed';
            fullBtn.style.cursor = 'not-allowed';
            
            const activeButton = testMode ? testBtn : fullBtn;
            const originalText = activeButton.innerHTML;
            activeButton.innerHTML = '<span class="loading-spinner"></span> AIåä½œå¼€å‘ä¸­...';
            activeButton.style.background = 'linear-gradient(135deg, #ff6b6b, #ee5a52)';

            try {
                const response = await fetch('/api/start-integrated-ai-development', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        user_id: currentUserId,
                        requirement: requirement,
                        test_mode: testMode
                    })
                });

                const result = await response.json();
                
                if (response.ok) {
                    currentProject = { id: result.project_id };
                    showNotification('ğŸš€ AIåä½œå¼€å‘å·²å¯åŠ¨ï¼', 'success');
                    
                    // å¯åŠ¨å®Œæ•´çš„å¼€å‘æµç¨‹æ¨¡æ‹Ÿ
                    await simulateFullDevelopmentProcess(testMode);
                    
                    if (testMode && !hasUsedFreeTest) {
                        hasUsedFreeTest = true;
                        updateCostDisplay();
                    }
                    
                    loadUserData();
                } else {
                    throw new Error(result.detail || 'AIå¼€å‘å¯åŠ¨å¤±è´¥');
                }
            } catch (error) {
                showNotification(error.message, 'error');
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                testBtn.disabled = false;
                fullBtn.disabled = false;
                testBtn.style.opacity = '1';
                fullBtn.style.opacity = '1';
                testBtn.style.cursor = 'pointer';
                fullBtn.style.cursor = 'pointer';
                activeButton.innerHTML = originalText;
                activeButton.style.background = '';
            }
        }

        // æ¨¡æ‹Ÿå®Œæ•´å¼€å‘æµç¨‹
        async function simulateFullDevelopmentProcess(testMode) {
            const stages = [
                { progress: 10, message: 'ğŸ¤– å¤šé‡AIç³»ç»Ÿåˆå§‹åŒ–ä¸­...', duration: 2000 },
                { progress: 20, message: 'ğŸ“‹ æ–‡æ¡£AIæ­£åœ¨åˆ†æéœ€æ±‚...', duration: 3000 },
                { progress: 35, message: 'ğŸ“ ç”Ÿæˆè¯¦ç»†é¡¹ç›®æ–‡æ¡£...', duration: 2500 },
                { progress: 50, message: 'ğŸ’¾ æ–‡æ¡£ç”Ÿæˆå®Œæˆï¼Œç­‰å¾…ç”¨æˆ·ç¡®è®¤...', duration: 1000, needsConfirmation: true },
            ];
            
            // å¦‚æœæ˜¯æµ‹è¯•æ¨¡å¼ï¼Œç¼©çŸ­æ—¶é—´
            if (testMode) {
                stages.forEach(stage => stage.duration = Math.max(500, stage.duration / 3));
            }

            for (const stage of stages) {
                updateProgress(stage.progress, stage.message);
                await new Promise(resolve => setTimeout(resolve, stage.duration));
                
                if (stage.needsConfirmation) {
                    // æ˜¾ç¤ºæ–‡æ¡£ç¡®è®¤é˜¶æ®µ
                    showDocumentReadyNotification();
                    break; // ç­‰å¾…ç”¨æˆ·ç¡®è®¤æ–‡æ¡£
                }
            }
        }

        // ç»§ç»­å¼€å‘æµç¨‹ï¼ˆæ–‡æ¡£ç¡®è®¤åï¼‰
        async function continueAfterDocumentConfirmation() {
            const stages = [
                { progress: 60, message: 'âš¡ å¼€å‘AIå¼€å§‹ä»£ç ç”Ÿæˆ...', duration: 4000 },
                { progress: 75, message: 'ğŸ”§ ç”Ÿæˆå‰ç«¯ç•Œé¢ä»£ç ...', duration: 3000 },
                { progress: 85, message: 'ğŸ–¥ï¸ å‰ç«¯ç•Œé¢ç”Ÿæˆå®Œæˆï¼Œç­‰å¾…ç”¨æˆ·ç¡®è®¤...', duration: 1000, needsConfirmation: true },
            ];

            for (const stage of stages) {
                updateProgress(stage.progress, stage.message);
                await new Promise(resolve => setTimeout(resolve, stage.duration));
                
                if (stage.needsConfirmation) {
                    showFrontendReadyNotification();
                    break; // ç­‰å¾…ç”¨æˆ·ç¡®è®¤å‰ç«¯
                }
            }
        }

        // å®Œæˆå¼€å‘æµç¨‹ï¼ˆå‰ç«¯ç¡®è®¤åï¼‰
        async function finalizeDevelopment() {
            const stages = [
                { progress: 95, message: 'ğŸ” ç›‘ç£AIè´¨é‡æ£€æŸ¥ä¸­...', duration: 2000 },
                { progress: 98, message: 'ğŸ§ª æµ‹è¯•AIéªŒè¯åŠŸèƒ½...', duration: 1500 },
                { progress: 100, message: 'ğŸ‰ AIåä½œå¼€å‘å®Œæˆï¼é¡¹ç›®å·²å‡†å¤‡éƒ¨ç½²', duration: 1000 }
            ];

            for (const stage of stages) {
                updateProgress(stage.progress, stage.message);
                await new Promise(resolve => setTimeout(resolve, stage.duration));
            }

            // å¼€å‘å®Œæˆï¼Œæ¢å¤æŒ‰é’®ä½†ä¿æŒç¦ç”¨çŠ¶æ€
            const testBtn = document.getElementById('testBtn');
            const fullBtn = document.getElementById('fullBtn');
            
            testBtn.innerHTML = '<i class="fas fa-check"></i> å¼€å‘å®Œæˆ';
            fullBtn.innerHTML = '<i class="fas fa-check"></i> å¼€å‘å®Œæˆ';
            testBtn.style.background = 'linear-gradient(135deg, #00ff88, #00d4aa)';
            fullBtn.style.background = 'linear-gradient(135deg, #00ff88, #00d4aa)';
            
            showNotification('ğŸ‰ AIåä½œå¼€å‘å®Œæˆï¼è¯·æŸ¥çœ‹é¡¹ç›®ç®¡ç†é¡µé¢', 'success');
            loadProjectsList();
        }

        // æ˜¾ç¤ºæ–‡æ¡£å°±ç»ªé€šçŸ¥
        function showDocumentReadyNotification() {
            const notification = document.createElement('div');
            notification.className = 'notification success';
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                padding: 30px;
                background: rgba(0, 255, 136, 0.15);
                border: 2px solid var(--success-glow);
                border-radius: 20px;
                backdrop-filter: blur(20px);
                z-index: 1001;
                text-align: center;
                min-width: 400px;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            `;
            
            notification.innerHTML = `
                <h3 style="color: var(--success-glow); margin-bottom: 15px;">
                    <i class="fas fa-file-alt"></i> é¡¹ç›®æ–‡æ¡£å·²ç”Ÿæˆ
                </h3>
                <p style="margin-bottom: 20px; line-height: 1.6;">
                    AIå·²å®Œæˆé¡¹ç›®éœ€æ±‚åˆ†æå¹¶ç”Ÿæˆè¯¦ç»†æ–‡æ¡£ã€‚<br>
                    è¯·æŸ¥çœ‹æ–‡æ¡£å†…å®¹å¹¶ç¡®è®¤æ˜¯å¦ç¬¦åˆæ‚¨çš„è¦æ±‚ã€‚
                </p>
                <div style="display: flex; gap: 15px; justify-content: center;">
                    <button class="btn btn-primary" onclick="viewDocumentInteractive(currentProject?.id)" style="padding: 10px 20px;">
                        <i class="fas fa-file-text"></i> äº¤äº’å¼æ–‡æ¡£
                    </button>
                    <button class="btn btn-secondary" onclick="dismissNotification(this.closest('.notification'))" style="padding: 10px 20px;">
                        <i class="fas fa-times"></i> ç¨åæŸ¥çœ‹
                    </button>
                </div>
            `;
            
            document.body.appendChild(notification);
        }

        // æ˜¾ç¤ºå‰ç«¯å°±ç»ªé€šçŸ¥
        function showFrontendReadyNotification() {
            const notification = document.createElement('div');
            notification.className = 'notification success';
            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                padding: 30px;
                background: rgba(0, 255, 136, 0.15);
                border: 2px solid var(--success-glow);
                border-radius: 20px;
                backdrop-filter: blur(20px);
                z-index: 1001;
                text-align: center;
                min-width: 400px;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            `;
            
            notification.innerHTML = `
                <h3 style="color: var(--success-glow); margin-bottom: 15px;">
                    <i class="fas fa-palette"></i> å‰ç«¯ç•Œé¢å·²ç”Ÿæˆ
                </h3>
                <p style="margin-bottom: 20px; line-height: 1.6;">
                    AIå·²å®Œæˆå‰ç«¯ç•Œé¢è®¾è®¡å’Œä»£ç ç”Ÿæˆã€‚<br>
                    è¯·é¢„è§ˆç•Œé¢æ•ˆæœå¹¶ç¡®è®¤æ˜¯å¦æ»¡æ„ã€‚
                </p>
                <div style="display: flex; gap: 15px; justify-content: center;">
                    <button class="btn btn-primary" onclick="viewFrontend()" style="padding: 10px 20px;">
                        <i class="fas fa-eye"></i> é¢„è§ˆç•Œé¢
                    </button>
                    <button class="btn btn-secondary" onclick="dismissNotification(this.closest('.notification'))" style="padding: 10px 20px;">
                        <i class="fas fa-times"></i> ç¨åæŸ¥çœ‹
                    </button>
                </div>
            `;
            
            document.body.appendChild(notification);
        }

        // æŸ¥çœ‹æ–‡æ¡£
        function viewDocument() {
            if (currentProject && currentProject.id) {
                openDocumentViewer(currentProject.id);
            }
            dismissNotification(document.querySelector('.notification'));
        }

        // äº¤äº’å¼æ–‡æ¡£ç¼–è¾‘
        function viewDocumentInteractive(projectId) {
            const url = `/static/interactive_document_viewer.html?project_id=${projectId}&user_id=${currentUserId}`;
            window.open(url, '_blank', 'width=1400,height=900,scrollbars=yes,resizable=yes');
        }

        // æŸ¥çœ‹å‰ç«¯
        function viewFrontend() {
            if (currentProject && currentProject.id) {
                openFrontendEditor(currentProject.id);
            }
            dismissNotification(document.querySelector('.notification'));
        }

        // å¯è§†åŒ–å‰ç«¯ç¼–è¾‘
        function editFrontendInteractive(projectId) {
            const url = `/static/interactive_frontend_editor.html?project_id=${projectId}&user_id=${currentUserId}`;
            window.open(url, '_blank', 'width=1600,height=1000,scrollbars=yes,resizable=yes');
        }

        // å…³é—­é€šçŸ¥
        function dismissNotification(notification) {
            if (notification) {
                notification.style.opacity = '0';
                notification.style.transform = 'translate(-50%, -50%) scale(0.9)';
                setTimeout(() => notification.remove(), 300);
            }
        }

        // æ›´æ–°è¿›åº¦
        function updateProgress(percentage, text) {
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('progressText').textContent = text;
        }

        // æ·»åŠ AIæ—¥å¿—
        function addAILog(data) {
            const logsContainer = document.getElementById('aiLogs');
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            
            const statusIcon = getStatusIcon(data.action);
            logEntry.innerHTML = `
                <strong>[${data.ai_name}]</strong> ${statusIcon} ${data.action}: ${data.message}
                <div class="log-timestamp">${new Date(data.timestamp).toLocaleTimeString()}</div>
            `;
            
            logsContainer.appendChild(logEntry);
            logsContainer.scrollTop = logsContainer.scrollHeight;

            const progressMap = {
                'éœ€æ±‚åˆ†æ': 20,
                'ä»£ç ç”Ÿæˆ': 60,
                'ä»£ç ç”Ÿæˆå®Œæˆ': 90,
                'é¡¹ç›®å®Œæˆ': 100
            };
            
            const progress = progressMap[data.action] || 0;
            if (progress > 0) {
                updateProgress(progress, data.message);
            }
        }

        // è·å–çŠ¶æ€å›¾æ ‡
        function getStatusIcon(action) {
            const iconMap = {
                'éœ€æ±‚åˆ†æ': 'ğŸ§ ',
                'ä»£ç ç”Ÿæˆ': 'âš¡',
                'ä»£ç ç”Ÿæˆå®Œæˆ': 'âœ…',
                'è´¨é‡æ£€æŸ¥': 'ğŸ”',
                'æµ‹è¯•éªŒè¯': 'ğŸ§ª',
                'é¡¹ç›®å®Œæˆ': 'ğŸ‰'
            };
            return iconMap[action] || 'ğŸ¤–';
        }

        // å¤„ç†é¡¹ç›®å°±ç»ª
        function handleProjectReady(data) {
            currentProject = data.project;
            updateProgress(100, 'ğŸ‰ é¡¹ç›®ç”Ÿæˆå®Œæˆï¼è¯·æŸ¥çœ‹æ–‡æ¡£å’Œç•Œé¢');
            showNotification('é¡¹ç›®å·²ç”Ÿæˆå®Œæˆï¼è¯·è¿›è¡Œæ–‡æ¡£å’Œç•Œé¢ç¡®è®¤', 'success');
            loadProjectsList();
        }

        // åŠ è½½é¡¹ç›®åˆ—è¡¨
        async function loadProjectsList() {
            if (!currentUserId) return;

            try {
                const response = await fetch(`/api/user-projects/${currentUserId}`);
                if (response.ok) {
                    const projects = await response.json();
                    renderProjectsList(projects);
                }
            } catch (error) {
                console.error('åŠ è½½é¡¹ç›®åˆ—è¡¨å¤±è´¥:', error);
            }
        }

        // æ¸²æŸ“é¡¹ç›®åˆ—è¡¨
        function renderProjectsList(projects) {
            const container = document.getElementById('projectsList');
            
            if (!projects || projects.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 60px 20px; color: var(--text-secondary);">
                        <i class="fas fa-folder-open" style="font-size: 4rem; margin-bottom: 20px; opacity: 0.3;"></i>
                        <h3>æš‚æ— é¡¹ç›®</h3>
                        <p style="margin-top: 15px;">å¼€å§‹æ‚¨çš„ç¬¬ä¸€ä¸ªAIå¼€å‘é¡¹ç›®å§ï¼</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = projects.map(project => {
                const canViewDocument = project.document_content && !project.document_confirmed;
                const canEditFrontend = project.frontend_preview_url && !project.frontend_confirmed;
                const canViewOnly = project.document_confirmed || project.frontend_confirmed;
                const canDeploy = project.document_confirmed && project.frontend_confirmed && !project.deployment_url;
                const isCompleted = project.deployment_status === 'deployed';

                return `
                    <div class="glass" style="padding: 25px; margin: 20px 0; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-5px)'" onmouseout="this.style.transform='translateY(0)'">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                            <div>
                                <h3 style="color: var(--text-accent); margin-bottom: 8px; font-family: 'Orbitron', monospace;">${project.name}</h3>
                                <p style="color: var(--text-secondary); font-size: 0.9rem;">${project.description || 'æš‚æ— æè¿°'}</p>
                            </div>
                            <div style="text-align: right;">
                                <span class="status-indicator status-${getProjectStatus(project)}"></span>
                                <span style="font-size: 0.9rem; color: var(--text-secondary);">${getProjectStatusText(project)}</span>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 15px; margin: 20px 0; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 10px;">
                            <div style="text-align: center;">
                                <div style="color: var(--text-secondary); font-size: 0.8rem;">æ–‡æ¡£çŠ¶æ€</div>
                                <div style="color: ${project.document_confirmed ? 'var(--success-glow)' : 'var(--warning-glow)'}; font-weight: bold;">
                                    ${project.document_confirmed ? 'âœ… å·²ç¡®è®¤' : 'â³ å¾…ç¡®è®¤'}
                                </div>
                            </div>
                            <div style="text-align: center;">
                                <div style="color: var(--text-secondary); font-size: 0.8rem;">ç•Œé¢çŠ¶æ€</div>
                                <div style="color: ${project.frontend_confirmed ? 'var(--success-glow)' : 'var(--warning-glow)'}; font-weight: bold;">
                                    ${project.frontend_confirmed ? 'âœ… å·²ç¡®è®¤' : 'â³ å¾…ç¡®è®¤'}
                                </div>
                            </div>
                            <div style="text-align: center;">
                                <div style="color: var(--text-secondary); font-size: 0.8rem;">éƒ¨ç½²çŠ¶æ€</div>
                                <div style="color: ${project.deployment_status === 'deployed' ? 'var(--success-glow)' : 'var(--text-secondary)'}; font-weight: bold;">
                                    ${project.deployment_status === 'deployed' ? 'ğŸš€ å·²éƒ¨ç½²' : 'ğŸ’¤ æœªéƒ¨ç½²'}
                                </div>
                            </div>
                            <div style="text-align: center;">
                                <div style="color: var(--text-secondary); font-size: 0.8rem;">é…é¢æ¶ˆè€—</div>
                                <div style="color: var(--primary-glow); font-weight: bold;">
                                    ${getProjectCost(project)} é…é¢
                                </div>
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 10px; margin-top: 20px; flex-wrap: wrap;">
                            ${canViewDocument ? `
                                <button class="btn" onclick="openDocumentViewer('${project.id}')" style="background: var(--warning-glow); color: var(--bg-dark);">
                                    <i class="fas fa-file-alt"></i> ç¡®è®¤æ–‡æ¡£
                                </button>
                            ` : ''}
                            
                            ${canEditFrontend ? `
                                <button class="btn" onclick="openFrontendEditor('${project.id}')" style="background: var(--accent-glow); color: var(--bg-dark);">
                                    <i class="fas fa-palette"></i> ç¡®è®¤ç•Œé¢
                                </button>
                            ` : ''}
                            
                            ${canViewOnly && project.document_confirmed ? `
                                <button class="btn" onclick="openDocumentViewer('${project.id}')" style="background: var(--text-secondary); color: var(--bg-dark);" disabled>
                                    <i class="fas fa-eye"></i> æŸ¥çœ‹æ–‡æ¡£
                                </button>
                            ` : ''}
                            
                            ${canViewOnly && project.frontend_confirmed ? `
                                <button class="btn" onclick="openFrontendEditor('${project.id}')" style="background: var(--text-secondary); color: var(--bg-dark);" disabled>
                                    <i class="fas fa-eye"></i> æŸ¥çœ‹ç•Œé¢
                                </button>
                            ` : ''}
                            
                            ${canDeploy ? `
                                <button class="btn" onclick="deployProject('${project.id}')" style="background: var(--success-glow); color: var(--bg-dark);">
                                    <i class="fas fa-rocket"></i> ç«‹å³éƒ¨ç½² (20é…é¢)
                                </button>
                            ` : ''}
                            
                            ${isCompleted && project.deployment_url ? `
                                <button class="btn" onclick="window.open('${project.deployment_url}', '_blank')" style="background: var(--success-glow); color: var(--bg-dark);">
                                    <i class="fas fa-external-link-alt"></i> è®¿é—®é¡¹ç›®
                                </button>
                                ${project.blockchain_deployed ? `
                                    <button class="btn" onclick="viewBlockchainInfo('${project.id}')" style="background: var(--primary-glow); color: var(--bg-dark);">
                                        <i class="fas fa-link"></i> å·²ä¸Šé“¾
                                    </button>
                                ` : `
                                    <button class="btn" onclick="deployToBlockchain('${project.id}')" style="background: var(--secondary-glow); color: var(--bg-dark);">
                                        <i class="fas fa-link"></i> ä¸€é”®ä¸Šé“¾ (${checkVipBenefits('blockchain') ? 'å…è´¹' : '30é…é¢'})
                                    </button>
                                `}
                            ` : ''}
                        </div>
                        
                        <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1); font-size: 0.8rem; color: var(--text-secondary);">
                            åˆ›å»ºæ—¶é—´: ${new Date(project.created_at).toLocaleString()}
                            ${project.deployed_at ? `<br>éƒ¨ç½²æ—¶é—´: ${new Date(project.deployed_at).toLocaleString()}` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // è·å–é¡¹ç›®æ¶ˆè€—é…é¢
        function getProjectCost(project) {
            let cost = 50; // åŸºç¡€å¼€å‘æˆæœ¬
            if (project.deployment_status === 'deployed') cost += 20; // éƒ¨ç½²æˆæœ¬
            if (project.blockchain_deployed) cost += 30; // ä¸Šé“¾æˆæœ¬
            return cost;
        }

        // éƒ¨ç½²é¡¹ç›®
        async function deployProject(projectId) {
            const currentBalance = parseInt(document.getElementById('apiBalance').textContent);
            if (currentBalance < 20) {
                showNotification('é…é¢ä¸è¶³ï¼éƒ¨ç½²éœ€è¦20ä¸ªé…é¢ï¼Œè¯·å…ˆå……å€¼', 'error');
                switchSection('recharge');
                return;
            }

            if (!confirm('ç¡®å®šè¦éƒ¨ç½²æ­¤é¡¹ç›®å—ï¼Ÿå°†æ¶ˆè€—20ä¸ªAPIé…é¢ã€‚')) {
                return;
            }

            try {
                showNotification('ğŸš€ é¡¹ç›®éƒ¨ç½²ä¸­...', 'info');
                
                const response = await fetch('/api/deploy-project', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        project_id: projectId,
                        user_id: currentUserId
                    })
                });

                if (response.ok) {
                    showNotification('ğŸ‰ é¡¹ç›®éƒ¨ç½²æˆåŠŸï¼', 'success');
                    loadProjectsList();
                    loadUserData();
                } else {
                    const error = await response.json();
                    showNotification(`éƒ¨ç½²å¤±è´¥ï¼š${error.detail}`, 'error');
                }
            } catch (error) {
                showNotification('éƒ¨ç½²å¼‚å¸¸ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // ä¸€é”®ä¸Šé“¾
        async function deployToBlockchain(projectId) {
            const currentBalance = parseInt(document.getElementById('apiBalance').textContent);
            if (currentBalance < 30) {
                showNotification('é…é¢ä¸è¶³ï¼ä¸Šé“¾éœ€è¦30ä¸ªé…é¢ï¼Œè¯·å…ˆå……å€¼', 'error');
                switchSection('recharge');
                return;
            }

            if (!confirm('ç¡®å®šè¦å°†æ­¤é¡¹ç›®ä¸Šé“¾å—ï¼Ÿå°†æ¶ˆè€—30ä¸ªAPIé…é¢ã€‚')) {
                return;
            }

            try {
                showNotification('â›“ï¸ é¡¹ç›®ä¸Šé“¾ä¸­...', 'info');
                
                const response = await fetch('/api/deploy-blockchain', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        project_id: projectId,
                        user_id: currentUserId
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    showNotification(`ğŸ‰ é¡¹ç›®æˆåŠŸä¸Šé“¾ï¼é“¾ä¸Šåœ°å€ï¼š${result.blockchain_address}`, 'success');
                    loadProjectsList();
                    loadUserData();
                } else {
                    const error = await response.json();
                    showNotification(`ä¸Šé“¾å¤±è´¥ï¼š${error.detail}`, 'error');
                }
            } catch (error) {
                showNotification('ä¸Šé“¾å¼‚å¸¸ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // è·å–é¡¹ç›®çŠ¶æ€
        function getProjectStatus(project) {
            if (project.deployment_status === 'deployed') return 'completed';
            if (project.document_confirmed && project.frontend_confirmed) return 'processing';
            return 'pending';
        }

        // è·å–é¡¹ç›®çŠ¶æ€æ–‡æœ¬
        function getProjectStatusText(project) {
            if (project.deployment_status === 'deployed') return 'å·²å®Œæˆ';
            if (project.document_confirmed && project.frontend_confirmed) return 'å‡†å¤‡éƒ¨ç½²';
            return 'å¼€å‘ä¸­';
        }

        // é€‰æ‹©å¥—é¤
        function selectPlan(planType, price, quota) {
            document.querySelectorAll('#rechargePlans .glass').forEach(card => {
                card.style.borderColor = 'rgba(0,245,255,0.3)';
                card.style.transform = 'scale(1)';
            });
            
            event.target.closest('.glass').style.borderColor = 'var(--primary-glow)';
            event.target.closest('.glass').style.transform = 'scale(1.05)';
            
            selectedPlan = { type: planType, price: price, quota: quota };
            
            const actualPrice = isFirstTimeUser ? price * 0.5 : price;
            document.getElementById('selectedPlanInfo').classList.remove('hidden');
            document.getElementById('planDetails').innerHTML = `
                <div style="font-size: 1.1rem; margin-bottom: 10px;">${planType}èƒ½é‡åŒ… - ${quota}ä¸ªAPIé…é¢</div>
                ${isFirstTimeUser ? 
                    `<div style="color: var(--warning-glow);">åŸä»·ï¼šï¿¥${price} â†’ <span style="color: var(--success-glow); font-weight: bold;">ä¼˜æƒ ä»·ï¼šï¿¥${actualPrice}</span> (é¦–å……åŠä»·)</div>` : 
                    `<div>ä»·æ ¼ï¼šï¿¥${price}</div>`
                }
            `;
            
            document.getElementById('paymentMethods').classList.remove('hidden');
        }

        // å¤„ç†æ”¯ä»˜
        async function processPayment(method) {
            if (!selectedPlan) return;
            
            const button = event.target;
            const originalText = button.innerHTML;
            button.disabled = true;
            button.innerHTML = '<span class="loading-spinner"></span> å¤„ç†ä¸­...';

            try {
                const response = await fetch('/api/recharge', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        user_id: currentUserId,
                        amount: selectedPlan.price,
                        api_quota: selectedPlan.quota,
                        payment_method: method
                    })
                });

                const result = await response.json();
                
                if (response.ok && result.success) {
                    // æ‰“å¼€çœŸå®æ”¯ä»˜é¡µé¢
                    const paymentUrl = `/payment/demo?order_id=${result.order_id}&amount=${result.final_amount}&method=${method}`;
                    const paymentWindow = window.open(paymentUrl, 'payment', 'width=700,height=800,scrollbars=yes,resizable=yes');
                    
                    if (paymentWindow) {
                        showNotification('ğŸ’³ æ”¯ä»˜çª—å£å·²æ‰“å¼€ï¼Œè¯·å®Œæˆæ”¯ä»˜', 'info');
                        
                        // ç›‘å¬æ”¯ä»˜çª—å£å…³é—­
                        const checkClosed = setInterval(() => {
                            if (paymentWindow.closed) {
                                clearInterval(checkClosed);
                                loadUserData(); // åˆ·æ–°ç”¨æˆ·æ•°æ®
                                showNotification('æ”¯ä»˜çª—å£å·²å…³é—­ï¼Œå¦‚å·²å®Œæˆæ”¯ä»˜è¯·ç¨ç­‰ç‰‡åˆ»æŸ¥çœ‹ä½™é¢å˜åŒ–', 'info');
                                
                                // é‡ç½®é€‰æ‹©çŠ¶æ€
                                document.getElementById('selectedPlanInfo').classList.add('hidden');
                                document.getElementById('paymentMethods').classList.add('hidden');
                            }
                        }, 1000);
                    } else {
                        showNotification('æ— æ³•æ‰“å¼€æ”¯ä»˜çª—å£ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨å¼¹çª—è®¾ç½®', 'error');
                    }
                } else {
                    showNotification(result.detail || 'å……å€¼å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                }
            } catch (error) {
                showNotification('ç½‘ç»œå¼‚å¸¸ï¼Œè¯·é‡è¯•', 'error');
            } finally {
                button.disabled = false;
                button.innerHTML = originalText;
            }
        }

        // çœŸå®åˆ†äº«åŠŸèƒ½
        async function shareToWeChat() {
            await realShareToPlatform('wechat');
        }

        async function shareToWeibo() {
            await realShareToPlatform('weibo');
        }

        async function shareToQQ() {
            await realShareToPlatform('qq');
        }

        async function shareToTelegram() {
            await realShareToPlatform('telegram');
        }

        async function shareToFacebook() {
            await realShareToPlatform('facebook');
        }

        async function shareToTwitter() {
            await realShareToPlatform('twitter');
        }

        // çœŸå®çš„å¹³å°åˆ†äº«å®ç°
        async function realShareToPlatform(platform) {
            if (!currentUserId) {
                showNotification('è¯·å…ˆç™»å½•', 'error');
                return;
            }

            try {
                const response = await fetch('/api/share', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        user_id: currentUserId,
                        platform: platform
                    })
                });

                const result = await response.json();
                
                if (response.ok && result.success) {
                    const shareUrl = result.share_url;
                    const platformName = result.platform_name;
                    
                    if (platform === 'wechat') {
                        // å¾®ä¿¡åˆ†äº«ï¼šå¤åˆ¶é“¾æ¥åˆ°å‰ªè´´æ¿
                        try {
                            await navigator.clipboard.writeText(shareUrl);
                            showNotification(`ğŸ“‹ ${platformName}åˆ†äº«é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼${result.message}`, 'success');
                        } catch (e) {
                            showNotification(`ğŸ”— åˆ†äº«é“¾æ¥ï¼š${shareUrl}`, 'info');
                        }
                    } else {
                        // å…¶ä»–å¹³å°ï¼šæ‰“å¼€åˆ†äº«çª—å£
                        const width = 600;
                        const height = 400;
                        const left = (screen.width - width) / 2;
                        const top = (screen.height - height) / 2;
                        
                        const shareWindow = window.open(
                            shareUrl,
                            'share',
                            `width=${width},height=${height},left=${left},top=${top},scrollbars=yes,resizable=yes`
                        );
                        
                        if (shareWindow) {
                            showNotification(`ğŸš€ ${platformName}åˆ†äº«çª—å£å·²æ‰“å¼€ï¼${result.message}`, 'success');
                        } else {
                            showNotification('æ— æ³•æ‰“å¼€åˆ†äº«çª—å£ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨å¼¹çª—è®¾ç½®', 'error');
                        }
                    }
                    
                    // åˆ·æ–°ç”¨æˆ·æ•°æ®ä»¥æ˜¾ç¤ºæ–°çš„å¥–åŠ±
                    loadUserData();
                } else {
                    showNotification(result.message || 'åˆ†äº«å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                }
            } catch (error) {
                showNotification('åˆ†äº«å¼‚å¸¸ï¼Œè¯·é‡è¯•', 'error');
                console.error('åˆ†äº«é”™è¯¯:', error);
            }
        }

        // ä¿ç•™å…¼å®¹æ€§çš„createShareå‡½æ•°
        async function createShare(shareType, platform) {
            await realShareToPlatform(platform);
        }

        // å¤åˆ¶é‚€è¯·ç 
        function copyInvitationCode() {
            const invitationCode = document.getElementById('invitationCode').textContent;
            if (invitationCode === 'åŠ è½½ä¸­...') {
                showNotification('é‚€è¯·ç è¿˜åœ¨åŠ è½½ä¸­', 'error');
                return;
            }
            
            navigator.clipboard.writeText(invitationCode).then(() => {
                showNotification('ğŸ”‘ ä¸“å±é‚€è¯·å¯†é’¥å·²å¤åˆ¶ï¼', 'success');
            }).catch(() => {
                showNotification('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
            });
        }

        // æ‰“å¼€æ–‡æ¡£æŸ¥çœ‹å™¨ - è·³è½¬åˆ°ç‹¬ç«‹é¡µé¢
        function openDocumentViewer(projectId = null) {
            const id = projectId || (currentProject ? currentProject.id : null);
            if (id) {
                window.open(`/static/document_viewer.html?project_id=${id}`, '_blank');
            } else {
                showNotification('è¯·å…ˆå®ŒæˆAIå¼€å‘æµç¨‹', 'error');
            }
        }

        // æ‰“å¼€å‰ç«¯ç¼–è¾‘å™¨ - è·³è½¬åˆ°ç‹¬ç«‹é¡µé¢
        function openFrontendEditor(projectId = null) {
            const id = projectId || (currentProject ? currentProject.id : null);
            if (id) {
                window.open(`/static/frontend_editor.html?project_id=${id}`, '_blank');
            } else {
                showNotification('è¯·å…ˆå®ŒæˆAIå¼€å‘æµç¨‹', 'error');
            }
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : type === 'error' ? 'fa-exclamation-circle' : 'fa-info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // VIPç›¸å…³åŠŸèƒ½
        async function loadVipInfo() {
            if (!currentUserId) return;
            
            try {
                const response = await fetch(`/api/vip-info/${currentUserId}`);
                if (response.ok) {
                    const vipInfo = await response.json();
                    userVipInfo = vipInfo;
                    updateVipDisplay(vipInfo);
                }
            } catch (error) {
                console.error('åŠ è½½VIPä¿¡æ¯å¤±è´¥:', error);
            }
        }

        function updateVipDisplay(vipInfo) {
            const levelNames = ["å¸¸è§„ä¼šå‘˜", "é«˜çº§ä¼šå‘˜", "è‡³å°Šä¼šå‘˜"];
            const levelColors = ["var(--text-secondary)", "#FFD700", "#8A2BE2"];
            const levelIcons = ["fa-user", "fa-crown", "fa-gem"];

            document.getElementById('currentVipLevel').textContent = levelNames[vipInfo.level];
            document.getElementById('currentVipLevel').style.color = levelColors[vipInfo.level];

            const expireText = vipInfo.level > 0 && vipInfo.expires_at ? 
                `åˆ°æœŸæ—¶é—´ï¼š${new Date(vipInfo.expires_at).toLocaleDateString()}` : 
                levelNames[vipInfo.level] === "å¸¸è§„ä¼šå‘˜" ? "äº«å—åŸºç¡€AIå¼€å‘æœåŠ¡" : "æ°¸ä¹…æœ‰æ•ˆ";
            document.getElementById('vipExpires').textContent = expireText;

            // æ›´æ–°VIPå¾½ç« 
            const badge = document.getElementById('vipBadge').querySelector('div');
            badge.style.background = vipInfo.level > 0 ? 
                `linear-gradient(135deg, ${levelColors[vipInfo.level]}, ${levelColors[vipInfo.level]}80)` : 
                'var(--text-secondary)';
            badge.innerHTML = `<i class="fas ${levelIcons[vipInfo.level]}"></i>`;

            // æ›´æ–°æƒç›Šæ˜¾ç¤º
            updateVipBenefits(vipInfo);
        }

        function updateVipBenefits(vipInfo) {
            const benefitsContainer = document.getElementById('vipBenefits');
            const benefits = vipInfo.benefits || [];

            benefitsContainer.innerHTML = benefits.map(benefit => `
                <div style="padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px; text-align: center;">
                    <i class="fas fa-check" style="color: var(--success-glow); margin-bottom: 8px;"></i>
                    <div style="font-size: 0.9rem;">${benefit}</div>
                </div>
            `).join('');

            if (benefits.length === 0) {
                benefitsContainer.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; color: var(--text-secondary); padding: 20px;">
                        <i class="fas fa-info-circle" style="margin-bottom: 10px;"></i>
                        <p>å‡çº§VIPè§£é”æ›´å¤šç‰¹æƒ</p>
                    </div>
                `;
            }
        }

        async function upgradeVIP(level) {
            const levelNames = ["", "é«˜çº§ä¼šå‘˜", "è‡³å°Šä¼šå‘˜"];
            const prices = [0, 100, 1000];

            if (!confirm(`ç¡®å®šè¦å‡çº§åˆ°${levelNames[level]}å—ï¼Ÿè´¹ç”¨ï¼šï¿¥${prices[level]}/æœˆ`)) {
                return;
            }

            try {
                const response = await fetch('/api/vip-upgrade', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        user_id: currentUserId,
                        vip_level: level,
                        payment_amount: prices[level]
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    showNotification(`ğŸ‰ æˆåŠŸå‡çº§åˆ°${levelNames[level]}ï¼èµ é€${result.credits_granted}é…é¢`, 'success');
                    loadVipInfo();
                    loadUserData();
                } else {
                    const error = await response.json();
                    showNotification(`å‡çº§å¤±è´¥ï¼š${error.detail}`, 'error');
                }
            } catch (error) {
                showNotification('ç½‘ç»œå¼‚å¸¸ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // æ£€æŸ¥VIPæƒç›Š
        function checkVipBenefits(action) {
            switch(action) {
                case 'deploy':
                    return userVipInfo.level >= 1; // é«˜çº§ä¼šå‘˜å…è´¹éƒ¨ç½²
                case 'blockchain':
                    return userVipInfo.level >= 1; // é«˜çº§ä¼šå‘˜å…è´¹ä¸Šé“¾
                case 'half_price':
                    return userVipInfo.level >= 2; // è‡³å°Šä¼šå‘˜åŠä»·
                default:
                    return false;
            }
        }

        // åº”ç”¨VIPå®šä»·
        function applyVipPricing(basePrice, action) {
            if (checkVipBenefits(action)) {
                return 0; // å…è´¹
            }
            if (checkVipBenefits('half_price')) {
                return Math.ceil(basePrice / 2); // åŠä»·
            }
            return basePrice;
        }

        // åŒºå—é“¾ç›¸å…³åŠŸèƒ½
        async function loadBlockchainData() {
            if (!currentUserId) return;
            
            try {
                // åŠ è½½åŒºå—é“¾è®°å½•
                const recordsResponse = await fetch(`/api/blockchain/records/${currentUserId}`);
                if (recordsResponse.ok) {
                    const recordsData = await recordsResponse.json();
                    renderBlockchainRecords(recordsData.records);
                }

                // åŠ è½½æ™ºèƒ½åˆçº¦
                const contractsResponse = await fetch(`/api/blockchain/contracts/${currentUserId}`);
                if (contractsResponse.ok) {
                    const contractsData = await contractsResponse.json();
                    renderSmartContracts(contractsData.contracts);
                }

                // åŠ è½½ç»Ÿè®¡ä¿¡æ¯
                const statsResponse = await fetch('/api/blockchain/statistics');
                if (statsResponse.ok) {
                    const stats = await statsResponse.json();
                    updateBlockchainStats(stats);
                }
            } catch (error) {
                console.error('åŠ è½½åŒºå—é“¾æ•°æ®å¤±è´¥:', error);
            }
        }

        function updateBlockchainStats(stats) {
            const projectCount = stats.records_by_type?.project || 0;
            const contractCount = Object.keys(stats.records_by_type || {}).length;
            const gasUsed = stats.total_gas_used || 0;

            document.getElementById('blockchainProjectCount').textContent = projectCount;
            document.getElementById('smartContractCount').textContent = contractCount;
            document.getElementById('totalGasUsed').textContent = gasUsed.toLocaleString();
        }

        function renderBlockchainRecords(records) {
            const container = document.getElementById('blockchainRecords');
            
            if (!records || records.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; color: var(--text-secondary); padding: 60px 20px;">
                        <i class="fas fa-cube" style="font-size: 2rem; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>æš‚æ— åŒºå—é“¾è®°å½•</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = records.map(record => `
                <div class="glass" style="padding: 20px; margin: 15px 0; transition: all 0.3s ease;">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 15px;">
                        <div>
                            <h4 style="color: var(--text-accent); margin-bottom: 5px;">
                                <i class="fas fa-${getRecordIcon(record.record_type)}"></i>
                                ${getRecordTypeName(record.record_type)}
                            </h4>
                            <p style="color: var(--text-secondary); font-size: 0.9rem;">
                                ${new Date(record.created_at).toLocaleString()}
                            </p>
                        </div>
                        <span class="status-indicator status-completed"></span>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 10px; font-size: 0.9rem;">
                        <div>
                            <div style="color: var(--text-secondary);">åŒºå—é“¾åœ°å€</div>
                            <div style="color: var(--primary-glow); font-family: monospace; word-break: break-all;">
                                ${record.blockchain_address.substring(0, 20)}...
                            </div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary);">ç½‘ç»œ</div>
                            <div style="color: var(--accent-glow); text-transform: capitalize;">
                                ${record.network || 'Polygon'}
                            </div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary);">Gasæ¶ˆè€—</div>
                            <div style="color: var(--warning-glow);">
                                ${record.gas_used?.toLocaleString() || 'N/A'}
                            </div>
                        </div>
                        <div>
                            <div style="color: var(--text-secondary);">åŒºå—é«˜åº¦</div>
                            <div style="color: var(--success-glow);">
                                #${record.block_number?.toLocaleString() || 'N/A'}
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button class="btn" onclick="verifyBlockchainRecord('${record.record_id}')" style="background: var(--primary-glow); color: var(--bg-dark);">
                            <i class="fas fa-check-circle"></i> éªŒè¯
                        </button>
                        <button class="btn" onclick="window.open('https://polygonscan.com/tx/${record.transaction_hash}', '_blank')" style="background: var(--accent-glow); color: var(--bg-dark);">
                            <i class="fas fa-external-link-alt"></i> æµè§ˆå™¨æŸ¥çœ‹
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function renderSmartContracts(contracts) {
            const container = document.getElementById('smartContracts');
            
            if (!contracts || contracts.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; color: var(--text-secondary); padding: 60px 20px;">
                        <i class="fas fa-file-contract" style="font-size: 2rem; margin-bottom: 15px; opacity: 0.5;"></i>
                        <p>æš‚æ— æ™ºèƒ½åˆçº¦</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = contracts.map(contract => `
                <div class="glass" style="padding: 20px; margin: 15px 0;">
                    <div style="display: flex; justify-content: between; align-items: flex-start; margin-bottom: 15px;">
                        <div>
                            <h4 style="color: var(--text-accent); margin-bottom: 5px;">
                                <i class="fas fa-file-contract"></i>
                                ${getContractTypeName(contract.contract_type)}
                            </h4>
                            <p style="color: var(--text-secondary); font-size: 0.9rem;">
                                éƒ¨ç½²æ—¶é—´: ${new Date(contract.deployed_at).toLocaleString()}
                            </p>
                        </div>
                    </div>
                    
                    <div style="margin: 15px 0; padding: 15px; background: rgba(0,0,0,0.2); border-radius: 10px;">
                        <div style="color: var(--text-secondary); margin-bottom: 5px;">åˆçº¦åœ°å€</div>
                        <div style="color: var(--primary-glow); font-family: monospace; word-break: break-all; font-size: 0.9rem;">
                            ${contract.contract_address}
                        </div>
                    </div>
                    
                    <button class="btn" onclick="window.open('https://polygonscan.com/address/${contract.contract_address}', '_blank')" style="background: var(--success-glow); color: var(--bg-dark);">
                        <i class="fas fa-external-link-alt"></i> æŸ¥çœ‹åˆçº¦
                    </button>
                </div>
            `).join('');
        }

        function getRecordIcon(type) {
            const icons = {
                'project': 'project-diagram',
                'user_profile': 'user',
                'vip_status': 'crown',
                'transaction': 'exchange-alt'
            };
            return icons[type] || 'cube';
        }

        function getRecordTypeName(type) {
            const names = {
                'project': 'é¡¹ç›®ä¸Šé“¾',
                'user_profile': 'ç”¨æˆ·æ¡£æ¡ˆ',
                'vip_status': 'VIPçŠ¶æ€',
                'transaction': 'äº¤æ˜“è®°å½•'
            };
            return names[type] || 'æœªçŸ¥ç±»å‹';
        }

        function getContractTypeName(type) {
            const names = {
                'user_registry': 'ç”¨æˆ·æ³¨å†Œåˆçº¦',
                'project_registry': 'é¡¹ç›®æ³¨å†Œåˆçº¦',
                'vip_contract': 'VIPä¼šå‘˜åˆçº¦'
            };
            return names[type] || 'æ™ºèƒ½åˆçº¦';
        }

        // éƒ¨ç½²ç”¨æˆ·æ¡£æ¡ˆåˆ°åŒºå—é“¾
        async function deployUserProfileToBlockchain() {
            const currentBalance = parseInt(document.getElementById('apiBalance').textContent);
            if (currentBalance < 15) {
                showNotification('é…é¢ä¸è¶³ï¼ç”¨æˆ·æ¡£æ¡ˆä¸Šé“¾éœ€è¦15ä¸ªé…é¢', 'error');
                switchSection('recharge');
                return;
            }

            if (!confirm('ç¡®å®šè¦å°†ç”¨æˆ·æ¡£æ¡ˆéƒ¨ç½²åˆ°åŒºå—é“¾å—ï¼Ÿå°†æ¶ˆè€—15ä¸ªAPIé…é¢ã€‚')) {
                return;
            }

            try {
                showNotification('ğŸ“‹ ç”¨æˆ·æ¡£æ¡ˆä¸Šé“¾ä¸­...', 'info');
                
                const response = await fetch('/api/blockchain/deploy-user-profile', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        user_id: currentUserId,
                        network: 'polygon'
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    showNotification(`ğŸ‰ ç”¨æˆ·æ¡£æ¡ˆæˆåŠŸä¸Šé“¾ï¼åœ°å€ï¼š${result.blockchain_address.substring(0, 20)}...`, 'success');
                    loadBlockchainData();
                    loadUserData();
                } else {
                    const error = await response.json();
                    showNotification(`ä¸Šé“¾å¤±è´¥ï¼š${error.detail}`, 'error');
                }
            } catch (error) {
                showNotification('ä¸Šé“¾å¼‚å¸¸ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // éƒ¨ç½²VIPåˆçº¦åˆ°åŒºå—é“¾
        async function deployVipContractToBlockchain() {
            const currentBalance = parseInt(document.getElementById('apiBalance').textContent);
            if (currentBalance < 25) {
                showNotification('é…é¢ä¸è¶³ï¼VIPåˆçº¦éƒ¨ç½²éœ€è¦25ä¸ªé…é¢', 'error');
                switchSection('recharge');
                return;
            }

            if (!confirm('ç¡®å®šè¦å°†VIPçŠ¶æ€éƒ¨ç½²ä¸ºæ™ºèƒ½åˆçº¦å—ï¼Ÿå°†æ¶ˆè€—25ä¸ªAPIé…é¢ã€‚')) {
                return;
            }

            try {
                showNotification('ğŸ‘‘ VIPåˆçº¦éƒ¨ç½²ä¸­...', 'info');
                
                const response = await fetch('/api/blockchain/deploy-vip-contract', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        user_id: currentUserId,
                        network: 'ethereum'
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    showNotification(`ğŸ‰ VIPåˆçº¦éƒ¨ç½²æˆåŠŸï¼åœ°å€ï¼š${result.contract_address.substring(0, 20)}...`, 'success');
                    loadBlockchainData();
                    loadUserData();
                } else {
                    const error = await response.json();
                    showNotification(`éƒ¨ç½²å¤±è´¥ï¼š${error.detail}`, 'error');
                }
            } catch (error) {
                showNotification('éƒ¨ç½²å¼‚å¸¸ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // åˆ›å»ºåŒºå—é“¾èº«ä»½
        async function createBlockchainIdentity() {
            showNotification('ğŸ”‘ æ­£åœ¨åˆ›å»ºåŒºå—é“¾èº«ä»½...', 'info');
            
            // æ¨¡æ‹Ÿåˆ›å»ºè¿‡ç¨‹
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            const mockAddress = `0x${Array(5).fill(0).map(() => Math.random().toString(16).substr(2, 8)).join('')}`;
            showNotification(`ğŸ‰ åŒºå—é“¾èº«ä»½åˆ›å»ºæˆåŠŸï¼åœ°å€ï¼š${mockAddress.substring(0, 20)}...`, 'success');
        }

        // éªŒè¯åŒºå—é“¾è®°å½•
        async function verifyBlockchainRecord(recordId) {
            try {
                showNotification('ğŸ” éªŒè¯åŒºå—é“¾è®°å½•ä¸­...', 'info');
                
                const response = await fetch(`/api/blockchain/verify/${recordId}`);
                if (response.ok) {
                    const result = await response.json();
                    if (result.verified) {
                        showNotification(`âœ… è®°å½•éªŒè¯æˆåŠŸï¼ç¡®è®¤æ•°ï¼š${result.confirmations}`, 'success');
                    } else {
                        showNotification(`âŒ è®°å½•éªŒè¯å¤±è´¥ï¼š${result.error}`, 'error');
                    }
                } else {
                    showNotification('éªŒè¯å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                }
            } catch (error) {
                showNotification('éªŒè¯å¼‚å¸¸ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // æŸ¥çœ‹é¡¹ç›®åŒºå—é“¾ä¿¡æ¯
        function viewBlockchainInfo(projectId) {
            // æ‰“å¼€åŒºå—é“¾ä¿¡æ¯æ¨¡æ€æ¡†æˆ–è·³è½¬åˆ°è¯¦æƒ…é¡µ
            showNotification('ğŸ”— æŸ¥çœ‹é¡¹ç›®é“¾ä¸Šä¿¡æ¯...', 'info');
            switchSection('blockchain');
        }

        // çœŸå®åŒºå—é“¾åŠŸèƒ½
        function getSelectedNetwork() {
            const selected = document.querySelector('input[name="blockchain_network"]:checked');
            return selected ? selected.value : 'solana-devnet';
        }

        // åˆ›å»ºçœŸå®åŒºå—é“¾é’±åŒ…
        async function createRealBlockchainWallet() {
            if (!currentUserId) {
                showNotification('è¯·å…ˆç™»å½•', 'error');
                return;
            }

            const network = getSelectedNetwork();
            
            try {
                showNotification('ğŸ”‘ æ­£åœ¨åˆ›å»ºçœŸå®åŒºå—é“¾é’±åŒ…...', 'info');
                
                const response = await fetch('/api/blockchain/create-wallet', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        user_id: currentUserId,
                        network: network
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    showNotification(`ğŸ‰ ${network}é’±åŒ…åˆ›å»ºæˆåŠŸï¼åœ°å€ï¼š${result.wallet.address.substring(0, 20)}...`, 'success');
                    
                    // æ˜¾ç¤ºé’±åŒ…ä¿¡æ¯
                    showWalletInfo(result.wallet);
                    loadBlockchainData();
                } else {
                    const error = await response.json();
                    showNotification(`é’±åŒ…åˆ›å»ºå¤±è´¥ï¼š${error.detail}`, 'error');
                }
            } catch (error) {
                showNotification('é’±åŒ…åˆ›å»ºå¼‚å¸¸ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // å°†ç”¨æˆ·æ¡£æ¡ˆçœŸå®ä¸Šé“¾
        async function deployUserProfileToRealBlockchain() {
            if (!currentUserId) {
                showNotification('è¯·å…ˆç™»å½•', 'error');
                return;
            }

            const currentBalance = parseInt(document.getElementById('apiBalance').textContent);
            if (currentBalance < 15) {
                showNotification('é…é¢ä¸è¶³ï¼ç”¨æˆ·æ¡£æ¡ˆçœŸå®ä¸Šé“¾éœ€è¦15ä¸ªé…é¢', 'error');
                switchSection('recharge');
                return;
            }

            if (!confirm('ç¡®å®šè¦å°†ç”¨æˆ·æ¡£æ¡ˆçœŸå®éƒ¨ç½²åˆ°åŒºå—é“¾å—ï¼Ÿè¿™å°†æ°¸ä¹…å­˜å‚¨æ‚¨çš„æ•°æ®ï¼Œæ¶ˆè€—15ä¸ªAPIé…é¢ã€‚')) {
                return;
            }

            const network = getSelectedNetwork();

            try {
                showNotification('ğŸ“‹ ç”¨æˆ·æ¡£æ¡ˆçœŸå®ä¸Šé“¾ä¸­...', 'info');
                
                const response = await fetch('/api/blockchain/deploy-user-profile', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        user_id: currentUserId,
                        network: network
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    showNotification(`ğŸ‰ ç”¨æˆ·æ¡£æ¡ˆæˆåŠŸä¸Šé“¾ï¼äº¤æ˜“å“ˆå¸Œï¼š${result.transaction_hash.substring(0, 20)}...`, 'success');
                    
                    // æ˜¾ç¤ºä¸Šé“¾è¯¦æƒ…
                    showBlockchainDeploymentInfo(result);
                    loadBlockchainData();
                    loadUserData();
                } else {
                    const error = await response.json();
                    showNotification(`ä¸Šé“¾å¤±è´¥ï¼š${error.detail}`, 'error');
                }
            } catch (error) {
                showNotification('ä¸Šé“¾å¼‚å¸¸ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // æ˜¾ç¤ºé’±åŒ…è¯¦æƒ…
        async function showWalletDetails() {
            if (!currentUserId) {
                showNotification('è¯·å…ˆç™»å½•', 'error');
                return;
            }

            try {
                showNotification('ğŸ” æŸ¥è¯¢é’±åŒ…ä¿¡æ¯...', 'info');
                
                const response = await fetch(`/api/blockchain/wallet/${currentUserId}`);
                if (response.ok) {
                    const result = await response.json();
                    
                    if (result.wallets && result.wallets.length > 0) {
                        showWalletModal(result.wallets);
                    } else {
                        showNotification('æœªæ‰¾åˆ°é’±åŒ…ï¼Œè¯·å…ˆåˆ›å»ºé’±åŒ…', 'warning');
                    }
                } else {
                    const error = await response.json();
                    showNotification(`æŸ¥è¯¢å¤±è´¥ï¼š${error.detail}`, 'error');
                }
            } catch (error) {
                showNotification('æŸ¥è¯¢å¼‚å¸¸ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // æ˜¾ç¤ºé’±åŒ…ä¿¡æ¯å¼¹çª—
        function showWalletInfo(wallet) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); display: flex; align-items: center; 
                justify-content: center; z-index: 10000;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: var(--bg-dark); padding: 30px; border-radius: 15px; 
                    max-width: 500px; width: 90%; border: 1px solid var(--primary-glow);
                    box-shadow: 0 0 30px var(--primary-glow);
                ">
                    <h3 style="color: var(--text-accent); margin-bottom: 20px; text-align: center;">
                        <i class="fas fa-wallet"></i> é’±åŒ…åˆ›å»ºæˆåŠŸ
                    </h3>
                    
                    <div style="margin: 15px 0; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px;">
                        <div style="color: var(--text-secondary); margin-bottom: 5px;">ç½‘ç»œ</div>
                        <div style="color: var(--primary-glow); font-weight: bold;">${wallet.network}</div>
                    </div>
                    
                    <div style="margin: 15px 0; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px;">
                        <div style="color: var(--text-secondary); margin-bottom: 5px;">åœ°å€</div>
                        <div style="color: var(--success-glow); font-family: monospace; word-break: break-all; font-size: 0.9rem;">
                            ${wallet.address}
                        </div>
                    </div>
                    
                    <div style="margin: 15px 0; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px;">
                        <div style="color: var(--text-secondary); margin-bottom: 5px;">ä½™é¢</div>
                        <div style="color: var(--accent-glow); font-weight: bold;">${wallet.balance || 0} ${wallet.network.startsWith('solana') ? 'SOL' : 'ETH'}</div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                                style="background: var(--primary-glow); color: var(--bg-dark); 
                                       border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer;">
                            ç¡®å®š
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // ç‚¹å‡»èƒŒæ™¯å…³é—­
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // æ˜¾ç¤ºé’±åŒ…è¯¦æƒ…å¼¹çª—
        function showWalletModal(wallets) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); display: flex; align-items: center; 
                justify-content: center; z-index: 10000;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: var(--bg-dark); padding: 30px; border-radius: 15px; 
                    max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto;
                    border: 1px solid var(--primary-glow); box-shadow: 0 0 30px var(--primary-glow);
                ">
                    <h3 style="color: var(--text-accent); margin-bottom: 20px; text-align: center;">
                        <i class="fas fa-wallet"></i> æˆ‘çš„åŒºå—é“¾é’±åŒ…
                    </h3>
                    
                    ${wallets.map(wallet => `
                        <div style="margin: 20px 0; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 10px; border-left: 4px solid var(--primary-glow);">
                            <h4 style="color: var(--success-glow); margin-bottom: 15px;">${wallet.network}</h4>
                            
                            <div style="margin: 10px 0;">
                                <div style="color: var(--text-secondary); font-size: 0.9rem;">åœ°å€</div>
                                <div style="color: var(--text-accent); font-family: monospace; word-break: break-all; font-size: 0.8rem;">
                                    ${wallet.address}
                                </div>
                            </div>
                            
                            <div style="margin: 10px 0;">
                                <div style="color: var(--text-secondary); font-size: 0.9rem;">ä½™é¢</div>
                                <div style="color: var(--accent-glow); font-weight: bold;">
                                    ${wallet.formatted_balance || wallet.balance || 0} ${wallet.network.startsWith('solana') ? 'SOL' : 'ETH'}
                                </div>
                            </div>
                            
                            <div style="margin-top: 15px;">
                                <button onclick="window.open('${wallet.explorer_url || '#'}', '_blank')" 
                                        style="background: var(--accent-glow); color: var(--bg-dark); 
                                               border: none; padding: 8px 15px; border-radius: 15px; cursor: pointer; font-size: 0.8rem;">
                                    <i class="fas fa-external-link-alt"></i> åŒºå—é“¾æµè§ˆå™¨
                                </button>
                            </div>
                        </div>
                    `).join('')}
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                                style="background: var(--primary-glow); color: var(--bg-dark); 
                                       border: none; padding: 10px 30px; border-radius: 25px; cursor: pointer;">
                            å…³é—­
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // ç‚¹å‡»èƒŒæ™¯å…³é—­
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // æ˜¾ç¤ºåŒºå—é“¾éƒ¨ç½²ä¿¡æ¯
        function showBlockchainDeploymentInfo(result) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                background: rgba(0,0,0,0.8); display: flex; align-items: center; 
                justify-content: center; z-index: 10000;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: var(--bg-dark); padding: 30px; border-radius: 15px; 
                    max-width: 500px; width: 90%; border: 1px solid var(--success-glow);
                    box-shadow: 0 0 30px var(--success-glow);
                ">
                    <h3 style="color: var(--text-accent); margin-bottom: 20px; text-align: center;">
                        <i class="fas fa-check-circle"></i> æ•°æ®ä¸Šé“¾æˆåŠŸ
                    </h3>
                    
                    <div style="margin: 15px 0; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px;">
                        <div style="color: var(--text-secondary); margin-bottom: 5px;">äº¤æ˜“å“ˆå¸Œ</div>
                        <div style="color: var(--success-glow); font-family: monospace; word-break: break-all; font-size: 0.9rem;">
                            ${result.transaction_hash}
                        </div>
                    </div>
                    
                    <div style="margin: 15px 0; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px;">
                        <div style="color: var(--text-secondary); margin-bottom: 5px;">æ•°æ®å“ˆå¸Œ</div>
                        <div style="color: var(--primary-glow); font-family: monospace; word-break: break-all; font-size: 0.9rem;">
                            ${result.data_hash}
                        </div>
                    </div>
                    
                    <div style="margin: 15px 0; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px;">
                        <div style="color: var(--text-secondary); margin-bottom: 5px;">å­˜å‚¨æˆæœ¬</div>
                        <div style="color: var(--accent-glow); font-weight: bold;">${result.storage_cost || 0} SOL</div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px; display: flex; gap: 10px; justify-content: center;">
                        <button onclick="window.open('${result.explorer_url}', '_blank')" 
                                style="background: var(--accent-glow); color: var(--bg-dark); 
                                       border: none; padding: 10px 20px; border-radius: 25px; cursor: pointer;">
                            <i class="fas fa-external-link-alt"></i> æŸ¥çœ‹äº¤æ˜“
                        </button>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" 
                                style="background: var(--primary-glow); color: var(--bg-dark); 
                                       border: none; padding: 10px 20px; border-radius: 25px; cursor: pointer;">
                            ç¡®å®š
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // ç‚¹å‡»èƒŒæ™¯å…³é—­
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        // æ•°æ®åˆ†æåŠŸèƒ½
        async function loadAnalyticsData() {
            if (!currentUserId) return;
            
            try {
                // åŠ è½½ç”¨æˆ·ç»Ÿè®¡æ•°æ®
                await Promise.all([
                    loadCoreMetrics(),
                    loadUsageTrend(),
                    loadProjectDistribution(),
                    loadIncomeExpenseAnalysis(),
                    loadActivityAnalysis(),
                    generateGrowthSuggestions()
                ]);
            } catch (error) {
                console.error('åŠ è½½åˆ†ææ•°æ®å¤±è´¥:', error);
            }
        }

        async function loadCoreMetrics() {
            // è·å–ç”¨æˆ·é¡¹ç›®
            const projectsResponse = await fetch(`/api/user-projects/${currentUserId}`);
            if (projectsResponse.ok) {
                const projects = await projectsResponse.json();
                const completedProjects = projects.filter(p => p.status === 'completed').length;
                const completionRate = projects.length > 0 ? Math.round((completedProjects / projects.length) * 100) : 0;
                
                document.getElementById('analyticsProjectCount').textContent = projects.length;
                document.getElementById('projectCompletionRate').textContent = `${completionRate}%`;
            }

            // è·å–ç”¨æˆ·ç»Ÿè®¡
            const statsResponse = await fetch(`/api/user-stats/${currentUserId}`);
            if (statsResponse.ok) {
                const stats = await statsResponse.json();
                const user = stats.user;
                
                // è®¡ç®—å·²ä½¿ç”¨é…é¢ï¼ˆå‡è®¾æ€»å……å€¼ - å½“å‰ä½™é¢ï¼‰
                const quotaUsed = (user.total_recharge || 0) * 2 - (user.api_balance || 0); // å‡è®¾1å…ƒ=2é…é¢
                document.getElementById('analyticsQuotaUsed').textContent = Math.max(0, quotaUsed);
                document.getElementById('quotaRemaining').textContent = user.api_balance || 0;
            }

            // è·å–é‚€è¯·ç»Ÿè®¡
            const inviteResponse = await fetch(`/api/invitation-stats/${currentUserId}`);
            if (inviteResponse.ok) {
                const inviteStats = await inviteResponse.json();
                document.getElementById('analyticsInvitations').textContent = inviteStats.total_invitations || 0;
                document.getElementById('invitationRewards').textContent = inviteStats.total_rewards || 0;
            }
        }

        async function loadUsageTrend() {
            // æ¨¡æ‹Ÿ7å¤©ä½¿ç”¨è¶‹åŠ¿æ•°æ®
            const trendData = [
                { day: 'å‘¨ä¸€', usage: 20 },
                { day: 'å‘¨äºŒ', usage: 35 },
                { day: 'å‘¨ä¸‰', usage: 28 },
                { day: 'å‘¨å››', usage: 45 },
                { day: 'å‘¨äº”', usage: 60 },
                { day: 'å‘¨å…­', usage: 25 },
                { day: 'å‘¨æ—¥', usage: 15 }
            ];

            renderUsageTrendChart(trendData);
        }

        function renderUsageTrendChart(data) {
            const container = document.getElementById('usageTrendChart');
            const maxUsage = Math.max(...data.map(d => d.usage));
            
            container.innerHTML = `
                <div style="display: flex; align-items: end; justify-content: space-around; height: 250px; padding: 20px;">
                    ${data.map(day => `
                        <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                            <div style="
                                height: ${(day.usage / maxUsage) * 200}px;
                                width: 30px;
                                background: linear-gradient(to top, var(--primary-glow), var(--accent-glow));
                                border-radius: 4px;
                                position: relative;
                                transition: all 0.3s ease;
                            " onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
                                <div style="
                                    position: absolute;
                                    top: -25px;
                                    left: 50%;
                                    transform: translateX(-50%);
                                    background: rgba(0,0,0,0.8);
                                    color: white;
                                    padding: 4px 8px;
                                    border-radius: 4px;
                                    font-size: 0.8rem;
                                    opacity: 0;
                                    transition: opacity 0.3s ease;
                                " class="chart-tooltip">${day.usage}é…é¢</div>
                            </div>
                            <span style="font-size: 0.8rem; color: var(--text-secondary);">${day.day}</span>
                        </div>
                    `).join('')}
                </div>
            `;

            // æ·»åŠ æ‚¬åœæ•ˆæœ
            container.querySelectorAll('[onmouseover]').forEach(bar => {
                bar.addEventListener('mouseenter', function() {
                    this.querySelector('.chart-tooltip').style.opacity = '1';
                });
                bar.addEventListener('mouseleave', function() {
                    this.querySelector('.chart-tooltip').style.opacity = '0';
                });
            });
        }

        async function loadProjectDistribution() {
            try {
                const projectsResponse = await fetch(`/api/user-projects/${currentUserId}`);
                if (projectsResponse.ok) {
                    const projects = await projectsResponse.json();
                    
                    const statusCounts = {
                        pending: projects.filter(p => p.status === 'pending').length,
                        'in_progress': projects.filter(p => p.status === 'in_progress').length,
                        completed: projects.filter(p => p.status === 'completed').length
                    };

                    renderProjectDistributionChart(statusCounts);
                }
            } catch (error) {
                console.error('åŠ è½½é¡¹ç›®åˆ†å¸ƒå¤±è´¥:', error);
            }
        }

        function renderProjectDistributionChart(statusCounts) {
            const container = document.getElementById('projectDistributionChart');
            const total = Object.values(statusCounts).reduce((a, b) => a + b, 0);
            
            if (total === 0) {
                container.innerHTML = `
                    <div style="text-align: center; color: var(--text-secondary);">
                        <i class="fas fa-chart-pie" style="font-size: 2rem; margin-bottom: 10px; opacity: 0.5;"></i>
                        <p>æš‚æ— é¡¹ç›®æ•°æ®</p>
                    </div>
                `;
                return;
            }

            const colors = {
                pending: 'var(--warning-glow)',
                'in_progress': 'var(--accent-glow)',
                completed: 'var(--success-glow)'
            };

            const labels = {
                pending: 'å¾…å¼€å§‹',
                'in_progress': 'è¿›è¡Œä¸­',
                completed: 'å·²å®Œæˆ'
            };

            container.innerHTML = `
                <div style="display: flex; flex-direction: column; align-items: center; height: 100%;">
                    <!-- ç®€åŒ–çš„é¥¼å›¾ -->
                    <div style="position: relative; width: 150px; height: 150px; margin-bottom: 20px;">
                        ${Object.entries(statusCounts).map(([status, count], index) => {
                            const percentage = (count / total) * 100;
                            const angle = (count / total) * 360;
                            return `
                                <div style="
                                    position: absolute;
                                    width: 150px;
                                    height: 150px;
                                    border-radius: 50%;
                                    background: conic-gradient(
                                        ${colors[status]} 0deg ${angle}deg,
                                        transparent ${angle}deg 360deg
                                    );
                                    transform: rotate(${index * 120}deg);
                                " title="${labels[status]}: ${count}ä¸ª (${percentage.toFixed(1)}%)"></div>
                            `;
                        }).join('')}
                        <div style="
                            position: absolute;
                            top: 50%;
                            left: 50%;
                            transform: translate(-50%, -50%);
                            background: var(--bg-dark);
                            width: 80px;
                            height: 80px;
                            border-radius: 50%;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            font-weight: bold;
                            color: var(--text-accent);
                        ">${total}</div>
                    </div>

                    <!-- å›¾ä¾‹ -->
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        ${Object.entries(statusCounts).map(([status, count]) => `
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <div style="width: 12px; height: 12px; background: ${colors[status]}; border-radius: 2px;"></div>
                                <span style="font-size: 0.9rem;">${labels[status]}: ${count}ä¸ª</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        async function loadIncomeExpenseAnalysis() {
            try {
                // æ¨¡æ‹Ÿæ”¶æ”¯æ•°æ®
                const income = {
                    recharge: 200,
                    invite: 150,
                    share: 80
                };
                
                const totalIncome = Object.values(income).reduce((a, b) => a + b, 0);
                const totalExpense = 180; // æ¨¡æ‹Ÿæ”¯å‡º

                document.getElementById('totalIncome').textContent = totalIncome;
                document.getElementById('totalExpense').textContent = totalExpense;
                document.getElementById('rechargeIncome').textContent = `${income.recharge}é…é¢`;
                document.getElementById('inviteIncome').textContent = `${income.invite}é…é¢`;
                document.getElementById('shareIncome').textContent = `${income.share}é…é¢`;
            } catch (error) {
                console.error('åŠ è½½æ”¶æ”¯åˆ†æå¤±è´¥:', error);
            }
        }

        async function loadActivityAnalysis() {
            try {
                // æ¨¡æ‹Ÿæ´»è·ƒåº¦æ•°æ®
                const activity = {
                    loginDays: 15,
                    developmentCount: 8,
                    shareActivity: 65
                };

                document.getElementById('loginDays').textContent = `${activity.loginDays}å¤©`;
                document.getElementById('developmentCount').textContent = `${activity.developmentCount}æ¬¡`;
                document.getElementById('shareActivity').textContent = `${activity.shareActivity}%`;

                // æ›´æ–°è¿›åº¦æ¡
                document.getElementById('loginProgress').style.width = `${Math.min(activity.loginDays * 3.33, 100)}%`;
                document.getElementById('developmentProgress').style.width = `${Math.min(activity.developmentCount * 10, 100)}%`;
                document.getElementById('shareProgress').style.width = `${activity.shareActivity}%`;
            } catch (error) {
                console.error('åŠ è½½æ´»è·ƒåº¦åˆ†æå¤±è´¥:', error);
            }
        }

        async function generateGrowthSuggestions() {
            // åŸºäºç”¨æˆ·æ•°æ®ç”Ÿæˆæ™ºèƒ½å»ºè®®
            const suggestions = [
                {
                    icon: 'fas fa-rocket',
                    title: 'æå‡å¼€å‘æ•ˆç‡',
                    content: 'å»ºè®®æ‚¨å°è¯•ä½¿ç”¨å¿«é€ŸéªŒè¯æ¨¡å¼ï¼Œå¯ä»¥æ›´å¿«åœ°æµ‹è¯•AIå¼€å‘åŠŸèƒ½',
                    action: 'å»ä½“éªŒ',
                    color: 'var(--primary-glow)'
                },
                {
                    icon: 'fas fa-users',
                    title: 'é‚€è¯·æ›´å¤šæœ‹å‹',
                    content: 'æ‚¨çš„é‚€è¯·è½¬åŒ–ç‡å¾ˆé«˜ï¼ç»§ç»­åˆ†äº«å¯ä»¥è·å¾—æ›´å¤šé…é¢å¥–åŠ±',
                    action: 'å»åˆ†äº«',
                    color: 'var(--success-glow)'
                },
                {
                    icon: 'fas fa-crown',
                    title: 'å‡çº§VIPä¼šå‘˜',
                    content: 'æˆä¸ºVIPä¼šå‘˜å¯ä»¥äº«å—æ›´å¤šç‰¹æƒï¼ŒåŒ…æ‹¬å…è´¹éƒ¨ç½²å’Œä¸Šé“¾æœåŠ¡',
                    action: 'äº†è§£VIP',
                    color: 'var(--accent-glow)'
                }
            ];

            const container = document.getElementById('growthSuggestions');
            container.innerHTML = suggestions.map(suggestion => `
                <div class="glass" style="padding: 20px; margin: 15px 0; display: flex; align-items: center; gap: 20px;">
                    <div style="font-size: 2rem; color: ${suggestion.color};">
                        <i class="${suggestion.icon}"></i>
                    </div>
                    <div style="flex: 1;">
                        <h4 style="color: var(--text-accent); margin-bottom: 8px;">${suggestion.title}</h4>
                        <p style="color: var(--text-secondary); margin-bottom: 0; line-height: 1.4;">${suggestion.content}</p>
                    </div>
                    <button class="btn" style="background: ${suggestion.color}; color: var(--bg-dark); padding: 10px 20px;">
                        ${suggestion.action}
                    </button>
                </div>
            `).join('');
        }
    </script>
</body>
</html>